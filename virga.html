

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The Code &mdash; virga v2.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=aa039f9c"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Custom Fractal Aggregate Aerosols" href="notebooks/12_Custom_Fractal_Aggregate_Aerosols.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            virga
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference external" href="https://zenodo.org/records/15886530">Refractive Indices</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">The Tutorials</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/natashabatalha/virga">Github</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The Code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-virga.calc_mie">virga.calc_mie module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#virga.calc_mie.calc_new_mieff"><code class="docutils literal notranslate"><span class="pre">calc_new_mieff()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.calc_mie.calc_new_mieff_optool"><code class="docutils literal notranslate"><span class="pre">calc_new_mieff_optool()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.calc_mie.fort_mie_calc"><code class="docutils literal notranslate"><span class="pre">fort_mie_calc()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-virga.gas_properties">virga.gas_properties module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#virga.gas_properties.Al2O3"><code class="docutils literal notranslate"><span class="pre">Al2O3()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.gas_properties.CH4"><code class="docutils literal notranslate"><span class="pre">CH4()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.gas_properties.CaAl12O19"><code class="docutils literal notranslate"><span class="pre">CaAl12O19()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.gas_properties.CaTiO3"><code class="docutils literal notranslate"><span class="pre">CaTiO3()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.gas_properties.Cr"><code class="docutils literal notranslate"><span class="pre">Cr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.gas_properties.Fe"><code class="docutils literal notranslate"><span class="pre">Fe()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.gas_properties.H2O"><code class="docutils literal notranslate"><span class="pre">H2O()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.gas_properties.KCl"><code class="docutils literal notranslate"><span class="pre">KCl()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.gas_properties.Mg2SiO4"><code class="docutils literal notranslate"><span class="pre">Mg2SiO4()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.gas_properties.MgSiO3"><code class="docutils literal notranslate"><span class="pre">MgSiO3()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.gas_properties.MnS"><code class="docutils literal notranslate"><span class="pre">MnS()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.gas_properties.NH3"><code class="docutils literal notranslate"><span class="pre">NH3()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.gas_properties.Na2S"><code class="docutils literal notranslate"><span class="pre">Na2S()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.gas_properties.SiO2"><code class="docutils literal notranslate"><span class="pre">SiO2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.gas_properties.TiO2"><code class="docutils literal notranslate"><span class="pre">TiO2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.gas_properties.ZnS"><code class="docutils literal notranslate"><span class="pre">ZnS()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-virga.justdoit">virga.justdoit module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#virga.justdoit.Atmosphere"><code class="docutils literal notranslate"><span class="pre">Atmosphere</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#virga.justdoit.Atmosphere.compute"><code class="docutils literal notranslate"><span class="pre">Atmosphere.compute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#virga.justdoit.Atmosphere.constants"><code class="docutils literal notranslate"><span class="pre">Atmosphere.constants()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#virga.justdoit.Atmosphere.get_atmo_parameters"><code class="docutils literal notranslate"><span class="pre">Atmosphere.get_atmo_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#virga.justdoit.Atmosphere.get_kz_mixl"><code class="docutils literal notranslate"><span class="pre">Atmosphere.get_kz_mixl()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#virga.justdoit.Atmosphere.gravity"><code class="docutils literal notranslate"><span class="pre">Atmosphere.gravity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#virga.justdoit.Atmosphere.kz"><code class="docutils literal notranslate"><span class="pre">Atmosphere.kz()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#virga.justdoit.Atmosphere.ptk"><code class="docutils literal notranslate"><span class="pre">Atmosphere.ptk()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justdoit.available"><code class="docutils literal notranslate"><span class="pre">available()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justdoit.brown_dwarf"><code class="docutils literal notranslate"><span class="pre">brown_dwarf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justdoit.calc_mie_db"><code class="docutils literal notranslate"><span class="pre">calc_mie_db()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justdoit.calc_optics"><code class="docutils literal notranslate"><span class="pre">calc_optics()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justdoit.calc_optics_user_r_dist"><code class="docutils literal notranslate"><span class="pre">calc_optics_user_r_dist()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justdoit.calc_qc"><code class="docutils literal notranslate"><span class="pre">calc_qc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justdoit.compute"><code class="docutils literal notranslate"><span class="pre">compute()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justdoit.condensation_t"><code class="docutils literal notranslate"><span class="pre">condensation_t()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justdoit.convert_refrind_to_lnk"><code class="docutils literal notranslate"><span class="pre">convert_refrind_to_lnk()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justdoit.create_dict"><code class="docutils literal notranslate"><span class="pre">create_dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justdoit.eddysed"><code class="docutils literal notranslate"><span class="pre">eddysed()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justdoit.get_mie"><code class="docutils literal notranslate"><span class="pre">get_mie()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justdoit.get_r_grid"><code class="docutils literal notranslate"><span class="pre">get_r_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justdoit.get_r_grid_legacy"><code class="docutils literal notranslate"><span class="pre">get_r_grid_legacy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justdoit.get_r_grid_w_max"><code class="docutils literal notranslate"><span class="pre">get_r_grid_w_max()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justdoit.get_refrind"><code class="docutils literal notranslate"><span class="pre">get_refrind()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justdoit.hot_jupiter"><code class="docutils literal notranslate"><span class="pre">hot_jupiter()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justdoit.layer"><code class="docutils literal notranslate"><span class="pre">layer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justdoit.picaso_format"><code class="docutils literal notranslate"><span class="pre">picaso_format()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justdoit.picaso_format_custom_wavenumber_grid"><code class="docutils literal notranslate"><span class="pre">picaso_format_custom_wavenumber_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justdoit.picaso_format_slab"><code class="docutils literal notranslate"><span class="pre">picaso_format_slab()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justdoit.recommend_gas"><code class="docutils literal notranslate"><span class="pre">recommend_gas()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justdoit.temperate_neptune"><code class="docutils literal notranslate"><span class="pre">temperate_neptune()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justdoit.warm_neptune"><code class="docutils literal notranslate"><span class="pre">warm_neptune()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-virga.justplotit">virga.justplotit module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#virga.justplotit.aggregates_optical_properties"><code class="docutils literal notranslate"><span class="pre">aggregates_optical_properties()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justplotit.aggregates_pressure_vs_number_density"><code class="docutils literal notranslate"><span class="pre">aggregates_pressure_vs_number_density()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justplotit.aggregates_pressure_vs_radius"><code class="docutils literal notranslate"><span class="pre">aggregates_pressure_vs_radius()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justplotit.aggregates_wavelength_radius_grid"><code class="docutils literal notranslate"><span class="pre">aggregates_wavelength_radius_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justplotit.all_optics"><code class="docutils literal notranslate"><span class="pre">all_optics()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justplotit.all_optics_1d"><code class="docutils literal notranslate"><span class="pre">all_optics_1d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justplotit.condensate_mmr"><code class="docutils literal notranslate"><span class="pre">condensate_mmr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justplotit.find_nearest_1d"><code class="docutils literal notranslate"><span class="pre">find_nearest_1d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justplotit.fsed_from_output"><code class="docutils literal notranslate"><span class="pre">fsed_from_output()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justplotit.opd_by_gas"><code class="docutils literal notranslate"><span class="pre">opd_by_gas()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justplotit.plot_format"><code class="docutils literal notranslate"><span class="pre">plot_format()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justplotit.plot_fsed"><code class="docutils literal notranslate"><span class="pre">plot_fsed()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justplotit.pressure_fig"><code class="docutils literal notranslate"><span class="pre">pressure_fig()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justplotit.pt"><code class="docutils literal notranslate"><span class="pre">pt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.justplotit.radii"><code class="docutils literal notranslate"><span class="pre">radii()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-virga.optics">virga.optics module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#virga.optics.get_refrind"><code class="docutils literal notranslate"><span class="pre">get_refrind()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.optics.init_optics"><code class="docutils literal notranslate"><span class="pre">init_optics()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-virga.pvaps">virga.pvaps module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#virga.pvaps.Al2O3"><code class="docutils literal notranslate"><span class="pre">Al2O3()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.pvaps.CH4"><code class="docutils literal notranslate"><span class="pre">CH4()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.pvaps.CaAl12O19"><code class="docutils literal notranslate"><span class="pre">CaAl12O19()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.pvaps.CaTiO3"><code class="docutils literal notranslate"><span class="pre">CaTiO3()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.pvaps.Cr"><code class="docutils literal notranslate"><span class="pre">Cr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.pvaps.Fe"><code class="docutils literal notranslate"><span class="pre">Fe()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.pvaps.H2O"><code class="docutils literal notranslate"><span class="pre">H2O()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.pvaps.KCl"><code class="docutils literal notranslate"><span class="pre">KCl()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.pvaps.Mg2SiO4"><code class="docutils literal notranslate"><span class="pre">Mg2SiO4()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.pvaps.MgSiO3"><code class="docutils literal notranslate"><span class="pre">MgSiO3()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.pvaps.MnS"><code class="docutils literal notranslate"><span class="pre">MnS()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.pvaps.NH3"><code class="docutils literal notranslate"><span class="pre">NH3()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.pvaps.Na2S"><code class="docutils literal notranslate"><span class="pre">Na2S()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.pvaps.SiO2"><code class="docutils literal notranslate"><span class="pre">SiO2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.pvaps.TiO2"><code class="docutils literal notranslate"><span class="pre">TiO2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.pvaps.ZnS"><code class="docutils literal notranslate"><span class="pre">ZnS()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-virga.root_functions">virga.roo_functions module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#virga.root_functions.advdiff"><code class="docutils literal notranslate"><span class="pre">advdiff()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.root_functions.calculate_k0"><code class="docutils literal notranslate"><span class="pre">calculate_k0()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.root_functions.find_N_mon_and_r_mon"><code class="docutils literal notranslate"><span class="pre">find_N_mon_and_r_mon()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.root_functions.find_cond_t"><code class="docutils literal notranslate"><span class="pre">find_cond_t()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.root_functions.find_rg"><code class="docutils literal notranslate"><span class="pre">find_rg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.root_functions.force_balance"><code class="docutils literal notranslate"><span class="pre">force_balance()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.root_functions.moment"><code class="docutils literal notranslate"><span class="pre">moment()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.root_functions.qvs_below_model"><code class="docutils literal notranslate"><span class="pre">qvs_below_model()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.root_functions.solve_force_balance"><code class="docutils literal notranslate"><span class="pre">solve_force_balance()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.root_functions.vfall"><code class="docutils literal notranslate"><span class="pre">vfall()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.root_functions.vfall_aggregates"><code class="docutils literal notranslate"><span class="pre">vfall_aggregates()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.root_functions.vfall_aggregrates_ohno"><code class="docutils literal notranslate"><span class="pre">vfall_aggregrates_ohno()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.root_functions.vfall_find_root"><code class="docutils literal notranslate"><span class="pre">vfall_find_root()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#virga.root_functions.vfall_legacy"><code class="docutils literal notranslate"><span class="pre">vfall_legacy()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-virga">Module contents</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">virga</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">The Code</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/virga.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="the-code">
<h1>The Code<a class="headerlink" href="#the-code" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-virga.calc_mie">
<span id="virga-calc-mie-module"></span><h2>virga.calc_mie module<a class="headerlink" href="#module-virga.calc_mie" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="virga.calc_mie.calc_new_mieff">
<span class="sig-prename descclassname"><span class="pre">virga.calc_mie.</span></span><span class="sig-name descname"><span class="pre">calc_new_mieff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fort_calc_mie</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.calc_mie.calc_new_mieff" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.calc_mie.calc_new_mieff_optool">
<span class="sig-prename descclassname"><span class="pre">virga.calc_mie.</span></span><span class="sig-name descname"><span class="pre">calc_new_mieff_optool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optool_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_mon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_mon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.calc_mie.calc_new_mieff_optool" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave</strong> (<em>array</em>) – wavelength grid, in microns</p></li>
<li><p><strong>radius</strong> (<em>array</em>) – <dl class="simple">
<dt>effective (mean) particle radius, in centimeters</dt><dd><p>– if aggregates = False, this is the spherical particle radius
– if aggregates = True, this is the radius of a sphere of equivalent volume to the fractal aggregate</p>
</dd>
</dl>
</p></li>
<li><p><strong>bin_min</strong> (<em>array</em>) – minimum radius in each particle bin</p></li>
<li><p><strong>bin_max</strong> (<em>array</em>) – maximum radius in each particle bin</p></li>
<li><p><strong>gas</strong> (<em>string</em>) – particle species to condense</p></li>
<li><p><strong>optool_dir</strong> (<em>string</em>) – <dl class="simple">
<dt>directory location of compiled OPTOOL code. Assumes that .lnk files (the optool equivalent to .refrind) are stored in</dt><dd><p>a subdirectory within this folder.
– NOTE: these .lnk files must be in ascending wavelength order to correctly compute Mie coefficients!
– However, we will flip the arrays once calculated, so that .mieff files are consistently saved in order of descending wavelength.</p>
</dd>
</dl>
</p></li>
<li><p><strong>Df</strong> (<em>float</em>) – the fractal dimension, if aggregrates = True</p></li>
<li><p><strong>N_mon</strong> (<em>int</em>) – the number of monomers. If None, must set r_mon directly.</p></li>
<li><p><strong>r_mon</strong> (<em>float</em>) – monomer particle radius (cm), used if aggregates = True. Can set directly or calculate from N_mon.</p></li>
<li><p><strong>k0</strong> (<em>float</em>) – the fractal prefactor, either prescribed by user or calculated using Tazaki (2021) Eq 2</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>qext</strong> (<em>array</em>) – extinction effiencies for all particle radii/wavelengths</p></li>
<li><p><strong>qsca</strong> (<em>array</em>) – scattering effiencies for all particle radii/wavelengths</p></li>
<li><p><strong>cos_qscat</strong> (<em>array</em>) – average asymmetry parameter x Q_sca for all particle radii/wavelengths</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.calc_mie.fort_mie_calc">
<span class="sig-prename descclassname"><span class="pre">virga.calc_mie.</span></span><span class="sig-name descname"><span class="pre">fort_mie_calc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">RO</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RFR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RFI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">THET</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">JX</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RE2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TMAG2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">WVNO</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.calc_mie.fort_mie_calc" title="Link to this definition"></a></dt>
<dd><p>Given the refractive indices at a certain wavelength this module
calculates the Mie scattering by a stratified sphere.The basic code used
was that described in the report: “ Subroutines for computing the parameters of
the electromagnetic radiation scattered by a sphere “ J.V. Dave,
I B M Scientific Center, Palo Alto , California.
Report NO. 320 - 3236 .. MAY 1968 .</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>RO</strong> (<em>float</em>) – Outer Shell Radius (cm)</p></li>
<li><p><strong>RFR</strong> (<em>float</em>) – Real refractive index of shell layer (in the form n= RFR-i*RFI)</p></li>
<li><p><strong>RFI</strong> (<em>float</em>) – Imaginary refractive index of shell layer (in the form n= RFR-i*RFI)</p></li>
<li><p><strong>THET</strong> (<em>ndarray</em>) – Angle in degrees between the directions of the incident and the scattered radiation.</p></li>
<li><p><strong>JX</strong> (<em>integer</em>) – Total number of THET for which calculations are required</p></li>
<li><p><strong>R</strong> (<em>float</em>) – Radius of core (cm)`</p></li>
<li><p><strong>RE2</strong> (<em>float</em>) – Real refractive index of core (in the form n= RE2-i*TMAG2)</p></li>
<li><p><strong>TMAG2</strong> (<em>float</em>) – Imaginary refractive index of core (in the form n= RE2-i*TMAG2)</p></li>
<li><p><strong>WVNO</strong> (<em>float</em>) – Wave-number corresponding to the wavelength. (cm^-1)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>QEXT</strong> (<em>float</em>) – Efficiency factor for extinction,VAN DE HULST,P.14 ‘ 127</p></li>
<li><p><strong>QSCAT</strong> (<em>float</em>) – Efficiency factor for scattering,VAN DE HULST,P.14 ‘ 127</p></li>
<li><p><strong>CTBQRS</strong> (<em>float</em>) – Average(cos(theta))*QSCAT,VAN DE HULST,P.14 ‘ 127</p></li>
<li><p><strong>ISTATUS</strong> (<em>integer</em>) – Convergence indicator, 0 if converged, -1 if otherwise.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-virga.gas_properties">
<span id="virga-gas-properties-module"></span><h2>virga.gas_properties module<a class="headerlink" href="#module-virga.gas_properties" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="virga.gas_properties.Al2O3">
<span class="sig-prename descclassname"><span class="pre">virga.gas_properties.</span></span><span class="sig-name descname"><span class="pre">Al2O3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mw_atmos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_mmr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.Al2O3" title="Link to this definition"></a></dt>
<dd><p>Defines properties for Al2O3 as condensible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mw_atmos</strong> (<em>float</em>) – Mean molecular weight of the atmosphere amu</p></li>
<li><p><strong>gas_mmr</strong> (<em>float</em><em> , </em><em>optional</em>) – Gas mass mixing ratio
None points to the default value of : 2.51e-6</p></li>
<li><p><strong>mh</strong> (<em>float</em><em> , </em><em>optional</em>) – Metallicity, Default is 1=1xSolar</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Mean molecular weight of gas,</em></p></li>
<li><p><em>Gas mass mixing ratio</em></p></li>
<li><p><em>Density of gas cgs</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id1" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Gao, Peter, et al. “Aerosol composition of hot giant exoplanets dominated by silicates and hydrocarbon hazes.” Nature Astronomy (2020): 1-6.</p>
</aside>
<aside class="footnote brackets" id="id2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>Lodders, Katharina. “Solar system abundances of the elements.” Principles and perspectives in cosmochemistry. Springer, Berlin, Heidelberg, 2010. 379-417.</p>
</aside>
<aside class="footnote brackets" id="id3" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<p>Morley C.~V., Mukherjee S., Marley M.~S., Fortney J.~J., Visscher C., Lupu R., Gharib-Nezhad E., et al., 2024, ApJ, 975, 59. doi:10.3847/1538-4357/ad71d5</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.gas_properties.CH4">
<span class="sig-prename descclassname"><span class="pre">virga.gas_properties.</span></span><span class="sig-name descname"><span class="pre">CH4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mw_atmos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_mmr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.CH4" title="Link to this definition"></a></dt>
<dd><p>Defines properties for CH4 as condensible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mw_atmos</strong> (<em>float</em>) – Mean molecular weight of the atmosphere amu</p></li>
<li><p><strong>gas_mmr</strong> (<em>float</em><em> , </em><em>optional</em>) – Gas mass mixing ratio.
None points to the default value of : 4.9e-4</p></li>
<li><p><strong>mh</strong> (<em>float</em><em> , </em><em>optional</em>) – Metallicity, Default is 1=1xSolar</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>mean molecular weight of gas,</em></p></li>
<li><p><em>gas mass mixing ratio</em></p></li>
<li><p><em>density of gas cgs</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.gas_properties.CaAl12O19">
<span class="sig-prename descclassname"><span class="pre">virga.gas_properties.</span></span><span class="sig-name descname"><span class="pre">CaAl12O19</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mw_atmos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_mmr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.CaAl12O19" title="Link to this definition"></a></dt>
<dd><p>Defines properties for CaAl12O19 as condensible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mw_atmos</strong> (<em>float</em>) – Mean molecular weight of the atmosphere amu</p></li>
<li><p><strong>gas_mmr</strong> (<em>float</em><em> , </em><em>optional</em>) – Gas mass mixing ratio
None points to the default value of : 8.80e-7</p></li>
<li><p><strong>mh</strong> (<em>float</em><em> , </em><em>optional</em>) – Metallicity, Default is 1=1xSolar</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Mean molecular weight of gas,</em></p></li>
<li><p><em>Gas mass mixing ratio</em></p></li>
<li><p><em>Density of gas cgs</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.gas_properties.CaTiO3">
<span class="sig-prename descclassname"><span class="pre">virga.gas_properties.</span></span><span class="sig-name descname"><span class="pre">CaTiO3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mw_atmos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_mmr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.CaTiO3" title="Link to this definition"></a></dt>
<dd><p>Defines properties for CaTiO3 as condensible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mw_atmos</strong> (<em>float</em>) – Mean molecular weight of the atmosphere amu</p></li>
<li><p><strong>gas_mmr</strong> (<em>float</em><em> , </em><em>optional</em>) – Gas mass mixing ratio
None points to the default value of : 2.51e-6</p></li>
<li><p><strong>mh</strong> (<em>float</em><em> , </em><em>optional</em>) – Metallicity, Default is 1=1xSolar</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Mean molecular weight of gas,</em></p></li>
<li><p><em>Gas mass mixing ratio</em></p></li>
<li><p><em>Density of gas cgs</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.gas_properties.Cr">
<span class="sig-prename descclassname"><span class="pre">virga.gas_properties.</span></span><span class="sig-name descname"><span class="pre">Cr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mw_atmos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_mmr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.Cr" title="Link to this definition"></a></dt>
<dd><p>Defines properties for Cr as condensible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mw_atmos</strong> (<em>float</em>) – Mean molecular weight of the atmosphere amu</p></li>
<li><p><strong>gas_mmr</strong> (<em>float</em><em> , </em><em>optional</em>) – Gas mass mixing ratio
None points to the default value of :
1xSolar = 8.87e-7
10xSolar = 8.6803E-06
50xSolar = 4.1308E-05</p></li>
<li><p><strong>mh</strong> (<em>float</em><em> , </em><em>optional</em>) – Metallicity, Default is 1=1xSolar</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Mean molecular weight of gas,</em></p></li>
<li><p><em>Gas mass mixing ratio</em></p></li>
<li><p><em>Density of gas cgs</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id4" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Lodders, K. Solar System Abundances of the Elements. Astrophys. Space Sci.</p>
</aside>
</aside>
<p>Proc. 16, 379 (2010)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.gas_properties.Fe">
<span class="sig-prename descclassname"><span class="pre">virga.gas_properties.</span></span><span class="sig-name descname"><span class="pre">Fe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mw_atmos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_mmr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.Fe" title="Link to this definition"></a></dt>
<dd><p>Defines properties for Fe as condensible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mw_atmos</strong> (<em>float</em>) – Mean molecular weight of the atmosphere amu</p></li>
<li><p><strong>gas_mmr</strong> (<em>float</em><em> , </em><em>optional</em>) – Gas mass mixing ratio
None points to the default value of : 5.095e-5</p></li>
<li><p><strong>mh</strong> (<em>float</em><em> , </em><em>optional</em>) – Metallicity, Default is 1=1xSolar</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>mean molecular weight of gas,</em></p></li>
<li><p><em>gas mass mixing ratio</em></p></li>
<li><p><em>density of gas cgs</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id5" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Morley C.~V., Mukherjee S., Marley M.~S., Fortney J.~J., Visscher C., Lupu R., Gharib-Nezhad E., et al., 2024, ApJ, 975, 59. doi:10.3847/1538-4357/ad71d5</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.gas_properties.H2O">
<span class="sig-prename descclassname"><span class="pre">virga.gas_properties.</span></span><span class="sig-name descname"><span class="pre">H2O</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mw_atmos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_mmr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.H2O" title="Link to this definition"></a></dt>
<dd><p>Defines properties for H2O as condensible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mw_atmos</strong> (<em>float</em>) – Mean molecular weight of the atmosphere amu</p></li>
<li><p><strong>gas_mmr</strong> (<em>float</em><em> , </em><em>optional</em>) – Gas mass mixing ratio
None points to the default value of : 7.54e-4</p></li>
<li><p><strong>mh</strong> (<em>float</em><em> , </em><em>optional</em>) – Metallicity, Default is 1=1xSolar</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>mean molecular weight of gas,</em></p></li>
<li><p><em>gas mass mixing ratio</em></p></li>
<li><p><em>density of gas cgs</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.gas_properties.KCl">
<span class="sig-prename descclassname"><span class="pre">virga.gas_properties.</span></span><span class="sig-name descname"><span class="pre">KCl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mw_atmos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_mmr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.KCl" title="Link to this definition"></a></dt>
<dd><p>Defines properties for KCl as condensible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mw_atmos</strong> (<em>float</em>) – Mean molecular weight of the atmosphere amu</p></li>
<li><p><strong>gas_mmr</strong> (<em>float</em><em> , </em><em>optional</em>) – Gas mass mixing ratio</p></li>
<li><p><strong>mh</strong> (<em>float</em><em> , </em><em>optional</em>) – Metallicity, Default is 1=1xSolar</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Mean molecular weight of gas,</em></p></li>
<li><p><em>Gas mass mixing ratio</em></p></li>
<li><p><em>Density of gas cgs</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.gas_properties.Mg2SiO4">
<span class="sig-prename descclassname"><span class="pre">virga.gas_properties.</span></span><span class="sig-name descname"><span class="pre">Mg2SiO4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mw_atmos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_mmr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.Mg2SiO4" title="Link to this definition"></a></dt>
<dd><p>Defines properties for Mg2SiO4 as condensible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mw_atmos</strong> (<em>float</em>) – Mean molecular weight of the atmosphere amu</p></li>
<li><p><strong>gas_mmr</strong> (<em>float</em><em> , </em><em>optional</em>) – Gas mass mixing ratio
None points to the default value of : 3.58125e-05</p></li>
<li><p><strong>mh</strong> (<em>float</em><em> , </em><em>optional</em>) – Metallicity, Default is 1=1xSolar</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Mean molecular weight of gas,</em></p></li>
<li><p><em>Gas mass mixing ratio</em></p></li>
<li><p><em>Density of gas cgs</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id6" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Morley C.~V., Mukherjee S., Marley M.~S., Fortney J.~J., Visscher C., Lupu R., Gharib-Nezhad E., et al., 2024, ApJ, 975, 59. doi:10.3847/1538-4357/ad71d5</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.gas_properties.MgSiO3">
<span class="sig-prename descclassname"><span class="pre">virga.gas_properties.</span></span><span class="sig-name descname"><span class="pre">MgSiO3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mw_atmos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_mmr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.MgSiO3" title="Link to this definition"></a></dt>
<dd><p>Defines properties for MgSiO3 as condensible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mw_atmos</strong> (<em>float</em>) – Mean molecular weight of the atmosphere amu</p></li>
<li><p><strong>gas_mmr</strong> (<em>float</em><em> , </em><em>optional</em>) – Gas mass mixing ratio
None points to the default value of : 2.75e-3</p></li>
<li><p><strong>mh</strong> (<em>float</em><em> , </em><em>optional</em>) – Metallicity, Default is 1=1xSolar</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Mean molecular weight of gas,</em></p></li>
<li><p><em>Gas mass mixing ratio</em></p></li>
<li><p><em>Density of gas cgs</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id7" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Morley C.~V., Mukherjee S., Marley M.~S., Fortney J.~J., Visscher C., Lupu R., Gharib-Nezhad E., et al., 2024, ApJ, 975, 59. doi:10.3847/1538-4357/ad71d5</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.gas_properties.MnS">
<span class="sig-prename descclassname"><span class="pre">virga.gas_properties.</span></span><span class="sig-name descname"><span class="pre">MnS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mw_atmos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_mmr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.MnS" title="Link to this definition"></a></dt>
<dd><p>Defines properties for MnS as condensible</p>
<blockquote>
<div><dl class="simple">
<dt>mw_atmos<span class="classifier">float</span></dt><dd><p>Mean molecular weight of the atmosphere amu</p>
</dd>
<dt>gas_mmr<span class="classifier">float , optional</span></dt><dd><p>Gas mass mixing ratio
None points to the default value of : 6.32e-7</p>
</dd>
<dt>mh<span class="classifier">float , optional</span></dt><dd><p>Metallicity, Default is 1=1xSolar</p>
</dd>
</dl>
<p>Mean molecular weight of gas,
Gas mass mixing ratio
Density of gas cgs</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id8" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Lodders, K. Solar System Abundances of the Elements. Astrophys. Space Sci.</p>
</aside>
</aside>
</div></blockquote>
<p>Proc. 16, 379 (2010)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.gas_properties.NH3">
<span class="sig-prename descclassname"><span class="pre">virga.gas_properties.</span></span><span class="sig-name descname"><span class="pre">NH3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mw_atmos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_mmr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.NH3" title="Link to this definition"></a></dt>
<dd><p>Defines properties for NH3 as condensible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mw_atmos</strong> (<em>float</em>) – Mean molecular weight of the atmosphere amu</p></li>
<li><p><strong>gas_mmr</strong> (<em>float</em><em> , </em><em>optional</em>) – Gas mass mixing ratio
None points to the default value of : 1.34e-4</p></li>
<li><p><strong>mh</strong> (<em>float</em><em> , </em><em>optional</em>) – Metallicity, Default is 1=1xSolar</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>mean molecular weight of gas,</em></p></li>
<li><p><em>gas mass mixing ratio</em></p></li>
<li><p><em>density of gas cgs</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.gas_properties.Na2S">
<span class="sig-prename descclassname"><span class="pre">virga.gas_properties.</span></span><span class="sig-name descname"><span class="pre">Na2S</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mw_atmos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_mmr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.Na2S" title="Link to this definition"></a></dt>
<dd><p>Defines properties for Na2S as condensible</p>
<blockquote>
<div><dl class="simple">
<dt>mw_atmos<span class="classifier">float</span></dt><dd><p>Mean molecular weight of the atmosphere amu</p>
</dd>
<dt>gas_mmr<span class="classifier">float , optional</span></dt><dd><p>Gas mass mixing ratio
None points to the default value of : 3.97e-6</p>
</dd>
<dt>mh<span class="classifier">float , optional</span></dt><dd><p>Metallicity, Default is 1=1xSolar</p>
</dd>
</dl>
<p>Mean molecular weight of gas,
Gas mass mixing ratio
Density of gas cgs</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id9" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Lodders, K. Solar System Abundances of the Elements. Astrophys. Space Sci.</p>
</aside>
</aside>
</div></blockquote>
<p>Proc. 16, 379 (2010)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.gas_properties.SiO2">
<span class="sig-prename descclassname"><span class="pre">virga.gas_properties.</span></span><span class="sig-name descname"><span class="pre">SiO2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mw_atmos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_mmr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.SiO2" title="Link to this definition"></a></dt>
<dd><p>Defines properties for TiO2 as condensible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mw_atmos</strong> (<em>float</em>) – Mean molecular weight of the atmosphere amu</p></li>
<li><p><strong>gas_mmr</strong> (<em>float</em><em> , </em><em>optional</em>) – Gas mass mixing ratio.
None points to the default value of : 1.69e-7</p></li>
<li><p><strong>mh</strong> (<em>float</em><em> , </em><em>optional</em>) – Metallicity, Default is 1=1xSolar</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>mean molecular weight of gas,</em></p></li>
<li><p><em>gas mass mixing ratio</em></p></li>
<li><p><em>density of gas cgs</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.gas_properties.TiO2">
<span class="sig-prename descclassname"><span class="pre">virga.gas_properties.</span></span><span class="sig-name descname"><span class="pre">TiO2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mw_atmos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_mmr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.TiO2" title="Link to this definition"></a></dt>
<dd><p>Defines properties for TiO2 as condensible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mw_atmos</strong> (<em>float</em>) – Mean molecular weight of the atmosphere amu</p></li>
<li><p><strong>gas_mmr</strong> (<em>float</em><em> , </em><em>optional</em>) – Gas mass mixing ratio.
None points to the default value of : 1.69e-7</p></li>
<li><p><strong>mh</strong> (<em>float</em><em> , </em><em>optional</em>) – Metallicity, Default is 1=1xSolar</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>mean molecular weight of gas,</em></p></li>
<li><p><em>gas mass mixing ratio</em></p></li>
<li><p><em>density of gas cgs</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.gas_properties.ZnS">
<span class="sig-prename descclassname"><span class="pre">virga.gas_properties.</span></span><span class="sig-name descname"><span class="pre">ZnS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mw_atmos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_mmr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.ZnS" title="Link to this definition"></a></dt>
<dd><p>Defines properties for ZnS as condensible</p>
<blockquote>
<div><dl class="simple">
<dt>mw_atmos<span class="classifier">float</span></dt><dd><p>Mean molecular weight of the atmosphere amu</p>
</dd>
<dt>gas_mmr<span class="classifier">float , optional</span></dt><dd><p>Gas mass mixing ratio
None points to the default value of : 8.40e-8</p>
</dd>
<dt>mh<span class="classifier">float , optional</span></dt><dd><p>Metallicity, Default is 1=1xSolar</p>
</dd>
</dl>
<p>Mean molecular weight of gas,
Gas mass mixing ratio
Density of gas cgs</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id10" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Lodders, K. Solar System Abundances of the Elements. Astrophys. Space Sci.</p>
</aside>
</aside>
</div></blockquote>
<p>Proc. 16, 379 (2010)</p>
</dd></dl>

</section>
<section id="module-virga.justdoit">
<span id="virga-justdoit-module"></span><h2>virga.justdoit module<a class="headerlink" href="#module-virga.justdoit" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="virga.justdoit.Atmosphere">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">virga.justdoit.</span></span><span class="sig-name descname"><span class="pre">Atmosphere</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">condensibles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fsed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'const'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supsat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_mmr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_mon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_mon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.Atmosphere" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="virga.justdoit.Atmosphere.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.Atmosphere.compute" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmo</strong> (<em>class</em>) – <cite>Atmosphere</cite> class</p></li>
<li><p><strong>directory</strong> (<em>str</em><em>, </em><em>optional</em>) – Directory string that describes where refrind files are</p></li>
<li><p><strong>as_dict</strong> (<em>bool</em>) – Default = True, option to view full output as dictionary</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>dict</em> – When as_dict=True. Dictionary output that contains full output. See tutorials for explanation of all output.</p></li>
<li><p><em>opd, w0, g0</em> – Extinction per layer, single scattering abledo, asymmetry parameter,
All are ndarrays that are nlayer by nwave</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="virga.justdoit.Atmosphere.constants">
<span class="sig-name descname"><span class="pre">constants</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.Atmosphere.constants" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="virga.justdoit.Atmosphere.get_atmo_parameters">
<span class="sig-name descname"><span class="pre">get_atmo_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.Atmosphere.get_atmo_parameters" title="Link to this definition"></a></dt>
<dd><p>Defines all the atmospheric parameters needed for the calculation</p>
<p>Note: Some of this is repeated in the layer() function.
This is done on purpose because layer is used to get a “virtual”
layer off the user input’s grid. These parameters are also
needed, though, to get the initial mixing parameters from the user.
Therefore, we put them in both places.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="virga.justdoit.Atmosphere.get_kz_mixl">
<span class="sig-name descname"><span class="pre">get_kz_mixl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant_kz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_heat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convective_overshoot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kz_min</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.Atmosphere.get_kz_mixl" title="Link to this definition"></a></dt>
<dd><p>Computes kz profile and mixing length given user input. In brief the options are:</p>
<ol class="arabic simple">
<li><p>Input Kz</p></li>
<li><p>Input constant kz</p></li>
</ol>
<p>3) Input convective heat flux (supply chf in df)
3a) Input convective heat flux, correct for latent heat (supply chf in df and set latent_heat=True)
and/or 3b) Input convective heat flux, correct for convective overshoot (supply chf, convective_overshoot=1/3)
4) Set kz_min to prevent kz from going too low (any of the above and set kz_min~1e5)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>dataframe</em><em> or </em><em>dict</em>) – Dataframe from input with “pressure”(bars),”temperature”(K). MUST have at least two
columns with names “pressure” and “temperature”.
Optional columns include the eddy diffusion “kz” in cm^2/s CGS units, and
the convective heat flux ‘chf’ also in cgs (e.g. sigma_csg T^4)</p></li>
<li><p><strong>constant_kz</strong> (<em>float</em>) – Constant value for kz, if kz is supplied in df or filename,
it will inheret that value and not use this constant_value
Default = None</p></li>
<li><p><strong>latent_heat</strong> (<em>bool</em>) – optional, Default = False. The latent heat factors into the mixing length.
When False, the mixing length goes as the scale height
When True, the mixing length is scaled by the latent heat</p></li>
<li><p><strong>convective_overshoot</strong> (<em>float</em>) – Optional, Default is None. But the default value used in
Ackerman &amp; Marley 2001 is 1./3. If you are unsure of what to pick, start
there. This is only used when the
This is ONLY used when a chf (convective heat flux) is supplied</p></li>
<li><p><strong>kz_min</strong> (<em>float</em>) – Minimum Kz value. This will reset everything below kz_min to kz_min.
Default = 1e5 cm2/s</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="virga.justdoit.Atmosphere.gravity">
<span class="sig-name descname"><span class="pre">gravity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gravity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gravity_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.Atmosphere.gravity" title="Link to this definition"></a></dt>
<dd><p>Get gravity based on mass and radius, or gravity inputs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gravity</strong> (<em>float</em>) – (Optional) Gravity of planet</p></li>
<li><p><strong>gravity_unit</strong> (<em>astropy.unit</em>) – (Optional) Unit of Gravity</p></li>
<li><p><strong>radius</strong> (<em>float</em>) – (Optional) radius of planet MUST be specified for thermal emission!</p></li>
<li><p><strong>radius_unit</strong> (<em>astropy.unit</em>) – (Optional) Unit of radius</p></li>
<li><p><strong>mass</strong> (<em>float</em>) – (Optional) mass of planet</p></li>
<li><p><strong>mass_unit</strong> (<em>astropy.unit</em>) – (Optional) Unit of mass</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="virga.justdoit.Atmosphere.kz">
<span class="sig-name descname"><span class="pre">kz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant_kz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kz_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_heat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.Atmosphere.kz" title="Link to this definition"></a></dt>
<dd><p>Define Kz in CGS. Should be on same grid as pressure. This overwrites whatever was
defined in get_pt ! Users can define kz by:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Defining a DataFrame with keys ‘pressure’ (in bars), and ‘kz’</p></li>
<li><p>Defining constant kz</p></li>
<li><p>Supplying a convective heat flux and prescription for latent_heat</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em><em>, </em><em>dict</em>) – Dataframe or dictionary with ‘kz’ as one of the fields.</p></li>
<li><p><strong>constant_kz</strong> (<em>float</em>) – Constant value for kz in units of cm^2/s</p></li>
<li><p><strong>chf</strong> (<em>ndarray</em>) – Convective heat flux in cgs units (e.g. sigma T^4). This will be used to compute
the kzz using the methodology of Gierasch and Conrath (1985)</p></li>
<li><p><strong>latent_heat</strong> (<em>bool</em>) – optional, Default = False. The latent heat factors into the mixing length.
When False, the mixing length goes as the scale height
When True, the mixing length is scaled by the latent heat
This is ONLY used when a chf (convective heat flux) is supplied</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="virga.justdoit.Atmosphere.ptk">
<span class="sig-name descname"><span class="pre">ptk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kz_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant_kz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_heat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convective_overshoot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Teff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_pressure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">pd_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.Atmosphere.ptk" title="Link to this definition"></a></dt>
<dd><p>Read in file or define dataframe.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>dataframe</em><em> or </em><em>dict</em>) – Dataframe with “pressure”(bars),”temperature”(K). MUST have at least two
columns with names “pressure” and “temperature”.
Optional columns include the eddy diffusion “kz” in cm^2/s CGS units, and
the convective heat flux ‘chf’ also in cgs (e.g. sigma_csg T^4)</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – Filename read in. Will be read in with pd.read_csv and should
result in two named headers “pressure”(bars),”temperature”(K).
Optional columns include the eddy diffusion “kz” in cm^2/s CGS units, and
the convective heat flux ‘chf’ also in cgs (e.g. sigma_csg T^4)
Use pd_kwargs to ensure file is read in properly.</p></li>
<li><p><strong>kz_min</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum Kz value. This will reset everything below kz_min to kz_min.
Default = 1e5 cm2/s</p></li>
<li><p><strong>constant_kz</strong> (<em>float</em><em>, </em><em>optional</em>) – Constant value for kz, if kz is supplied in df or filename,
it will inheret that value and not use this constant_value
Default = None</p></li>
<li><p><strong>latent_heat</strong> (<em>bool</em>) – optional, Default = False. The latent heat factors into the mixing length.
When False, the mixing length goes as the scale height
When True, the mixing length is scaled by the latent heat</p></li>
<li><p><strong>convective_overshoot</strong> (<em>float</em>) – Optional, Default is None. But the default value used in
Ackerman &amp; Marley 2001 is 1./3. If you are unsure of what to pick, start
there. This is only used when the
This is ONLY used when a chf (convective heat flux) is supplied</p></li>
<li><p><strong>Teff</strong> (<em>float</em><em>, </em><em>optional</em>) – Effective temperature. If None (default), Teff set to temperature at 1 bar</p></li>
<li><p><strong>alpha_pressure</strong> (<em>float</em>) – Pressure at which we want fsed=alpha for variable fsed calculation</p></li>
<li><p><strong>pd_kwargs</strong> (<em>kwargs</em>) – Pandas key words for file read in.
If reading old style eddysed files, you would need:
skiprows=3, sep=r’s+’, header=None, names=[“ind”,”pressure”,”temperature”,”kz”]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justdoit.available">
<span class="sig-prename descclassname"><span class="pre">virga.justdoit.</span></span><span class="sig-name descname"><span class="pre">available</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.available" title="Link to this definition"></a></dt>
<dd><p>Print all available gas condensates</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justdoit.brown_dwarf">
<span class="sig-prename descclassname"><span class="pre">virga.justdoit.</span></span><span class="sig-name descname"><span class="pre">brown_dwarf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.brown_dwarf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justdoit.calc_mie_db">
<span class="sig-prename descclassname"><span class="pre">virga.justdoit.</span></span><span class="sig-name descname"><span class="pre">calc_mie_db</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gas_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">virga_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optool_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.054239131</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nradii</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logspace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_mon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_mon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fort_calc_mie</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.calc_mie_db" title="Link to this definition"></a></dt>
<dd><p>Function that calculations new Mie database using MiePython (for spherical particles) or OPTOOL (for aggregates)
:param gas_name: List of names of gasses. Or a single gas name.</p>
<blockquote>
<div><p>See pyeddy.available() to see which ones are currently available.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>virga_dir</strong> (<em>str</em>) – Directory where you store the VIRGA refractive index files (.refind format).</p></li>
<li><p><strong>dir_out</strong> (<em>str</em>) – Directory where you want to store Mie parameter files. Will be stored as gas_name.Mieff.
BEWARE FILE OVERWRITES.</p></li>
<li><p><strong>optool_dir</strong> (<em>str</em>) – Directory where you store optool refractive index files (.lnk format).</p></li>
<li><p><strong>rmin</strong> (<em>float</em>) – (Default=1e-8) Units of cm. The minimum radius to compute Mie parameters for.
Usually 0.001 microns is small enough. However, if you notice your mean particle radius
is on the low end, you may compute your grid to even lower particle sizes.</p></li>
<li><p><strong>rmax</strong> (<em>float</em>) – (Default=5.4239131e-2) Units of cm. The maximum radius to compute Mie parameters for.
If your .mieff files take a long time to create, reduce this number. If you get a warning
that your particles are “off the grid” (larger than your maximum grid value), increase this number.</p></li>
<li><p><strong>nradii</strong> (<em>int</em><em>, </em><em>optional</em>) – (Default=60) number of radii points to compute grid on. 40 grid points for exoplanets/BDs</p></li>
<li><p><strong>logspace</strong> (<em>boolean</em><em>, </em><em>optional</em>) – (Default = True)
Spaces the radii logarithmically (which they generally tend to be in the clouds) if True. Spaces them linearly if False.</p></li>
<li><p><strong>aggregates</strong> (<em>boolean</em><em>, </em><em>optional</em>) – (Default = True)
Sets whether particles are aggregates or spheres. If true, we will calculate optical properties using OPTOOL instead of MiePython.</p></li>
<li><p><strong>Df</strong> (<em>If aggregates = True</em><em>, </em><em>the fractal dimension</em><em> of </em><em>the aggegrate particle. a number between 1 and 3.</em><em> (</em><em>3 would be equal to solid spheres with radii</em><em> of </em><em>the outer effective radius</em><em>)</em>)</p></li>
<li><p><strong>N_mon</strong> (<em>If aggregates = True</em><em>, </em><em>the number</em><em> of </em><em>monomers that make up an aggregate. Can set directly</em><em> or </em><em>calculate from r_mon.</em>)</p></li>
<li><p><strong>r_mon</strong> (<em>If aggregates = True</em><em>, </em><em>the monomer radius that makes up an aggregate particle</em><em> (</em><em>in cm</em><em>)</em><em>. Can either set</em><em> or </em><em>calculate from N_mon.</em>)</p></li>
<li><p><strong>k0</strong> (<em>only used if aggregate = True.</em>) – Default = 0, where it will then be calculated in the vfall equation using Tazaki (2021) Eq 2. k0 can also be prescribed by user,
but with a warning that when r_mon is fixed, unless d_f = 1 at r= r_mon, the dynamics may not be consistent between the boundary
when spheres grow large enough to become aggregates (this applies only when r_mon is fixed. If N_mon is fixed instead, any value of k0 is fine).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Q extinction, Q scattering,  asymmetry * Q scattering, radius grid (cm), wavelength grid (um)</em></p></li>
<li><p><em>The Q “efficiency factors” are = cross section / geometric cross section of particle</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justdoit.calc_optics">
<span class="sig-prename descclassname"><span class="pre">virga.justdoit.</span></span><span class="sig-name descname"><span class="pre">calc_optics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nwave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qext</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qscat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cos_qscat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.calc_optics" title="Link to this definition"></a></dt>
<dd><p>Calculate spectrally-resolved profiles of optical depth, single-scattering
albedo, and asymmetry parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nwave</strong> (<em>int</em>) – Number of wave points</p></li>
<li><p><strong>qc</strong> (<em>ndarray</em>) – Condensate mixing ratio</p></li>
<li><p><strong>qt</strong> (<em>ndarray</em>) – Gas + condensate mixing ratio</p></li>
<li><p><strong>rg</strong> (<em>ndarray</em>) – Geometric mean radius of condensate</p></li>
<li><p><strong>reff</strong> (<em>ndarray</em>) – Effective (area-weighted) radius of condensate (cm)</p></li>
<li><p><strong>ndz</strong> (<em>ndarray</em>) – Column density of particle concentration in layer (#/cm^2)</p></li>
<li><p><strong>radius</strong> (<em>ndarray</em>) – Particle radius bin centers from the grid (cm)</p></li>
<li><p><strong>dr</strong> (<em>ndarray</em>) – Width of radius bins (cm)</p></li>
<li><p><strong>qscat</strong> (<em>ndarray</em>) – Scattering efficiency</p></li>
<li><p><strong>qext</strong> (<em>ndarray</em>) – Extinction efficiency</p></li>
<li><p><strong>cos_qscat</strong> (<em>ndarray</em>) – qscat-weighted &lt;cos (scattering angle)&gt;</p></li>
<li><p><strong>sig</strong> (<em>float</em>) – Width of the log normal particle distribution</p></li>
<li><p><strong>rmin</strong> (<em>float</em>) – Minimum particle radius bin center from the grid (cm)</p></li>
<li><p><strong>rmax</strong> (<em>float</em>) – Maximum particle radius bin center from the grid (cm)</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – print out warnings or not</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>opd</strong> (<em>ndarray</em>) – extinction optical depth due to all condensates in layer</p></li>
<li><p><strong>w0</strong> (<em>ndarray</em>) – single scattering albedo</p></li>
<li><p><strong>g0</strong> (<em>ndarray</em>) – asymmetry parameter = Q_scat wtd avg of &lt;cos theta&gt;</p></li>
<li><p><strong>opd_gas</strong> (<em>ndarray</em>) – cumulative (from top) opd by condensing vapor as geometric conservative scatterers</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justdoit.calc_optics_user_r_dist">
<span class="sig-prename descclassname"><span class="pre">virga.justdoit.</span></span><span class="sig-name descname"><span class="pre">calc_optics_user_r_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_unit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_distribution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qext</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qscat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cos_qscat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.calc_optics_user_r_dist" title="Link to this definition"></a></dt>
<dd><p>Calculate spectrally-resolved profiles of optical depth, single-scattering
albedo, and asymmetry parameter for a user-input particle radius distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave_in</strong> (<em>ndarray</em>) – your wavelength grid in microns</p></li>
<li><p><strong>ndz</strong> (<em>float</em>) – <dl class="simple">
<dt>Column density of total particle concentration (#/cm^2)</dt><dd><p>Note: set to whatever, it’s your free knob
—- this does not directly translate to something physical because it’s for all particles in your slab
May have to use values of 1e8 or so</p>
</dd>
</dl>
</p></li>
<li><p><strong>radius</strong> (<em>ndarray</em>) – Radius bin values - the range of particle sizes of interest. Maybe measured in the lab,
Ensure radius_unit is specified</p></li>
<li><p><strong>radius_unit</strong> (<em>astropy.unit.Units</em>) – Astropy compatible unit</p></li>
<li><p><strong>qscat</strong> (<em>ndarray</em>) – Scattering efficiency</p></li>
<li><p><strong>qext</strong> (<em>ndarray</em>) – Extinction efficiency</p></li>
<li><p><strong>cos_qscat</strong> (<em>ndarray</em>) – qscat-weighted &lt;cos (scattering angle)&gt;</p></li>
<li><p><strong>r_distribution</strong> (<em>ndarray</em>) – the radius distribution in each bin. Maybe measured from the lab, generated from microphysics, etc.
Should integrate to 1.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – print out warnings or not</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>opd</strong> (<em>ndarray</em>) – extinction optical depth due to all condensates in layer</p></li>
<li><p><strong>w0</strong> (<em>ndarray</em>) – single scattering albedo</p></li>
<li><p><strong>g0</strong> (<em>ndarray</em>) – asymmetry parameter = Q_scat wtd avg of &lt;cos theta&gt;</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justdoit.calc_qc">
<span class="sig-prename descclassname"><span class="pre">virga.justdoit.</span></span><span class="sig-name descname"><span class="pre">calc_qc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gas_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supsat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_atmos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_cloud</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_below</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mixl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz_layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gravity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mw_atmos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mfp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">visc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_convect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fsed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_bot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_mon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_mon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">og_vfall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_cld</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.calc_qc" title="Link to this definition"></a></dt>
<dd><p>Calculate condensate number density and effective radius for a layer,
assuming geometric scatterers.</p>
<dl class="simple">
<dt>gas_name<span class="classifier">str</span></dt><dd><p>Name of condensate</p>
</dd>
<dt>supsat<span class="classifier">float</span></dt><dd><p>Super saturation factor</p>
</dd>
<dt>t_layer<span class="classifier">float</span></dt><dd><p>Temperature of layer mid-pt (K)</p>
</dd>
<dt>p_layer<span class="classifier">float</span></dt><dd><p>Pressure of layer mid-pt (dyne/cm^2)</p>
</dd>
<dt>r_atmos<span class="classifier">float</span></dt><dd><p>specific gas constant for atmosphere (erg/K/g)</p>
</dd>
<dt>r_cloud<span class="classifier">float</span></dt><dd><p>specific gas constant for cloud species (erg/K/g)</p>
</dd>
<dt>q_below<span class="classifier">float</span></dt><dd><p>total mixing ratio (vapor+condensate) below layer (g/g)</p>
</dd>
<dt>mxl<span class="classifier">float</span></dt><dd><p>convective mixing length scale (cm): no less than 1/10 scale height</p>
</dd>
<dt>dz_layer<span class="classifier">float</span></dt><dd><p>Thickness of layer cm</p>
</dd>
<dt>gravity<span class="classifier">float</span></dt><dd><p>Gravity of planet cgs</p>
</dd>
<dt>mw_atmos<span class="classifier">float</span></dt><dd><p>Molecular weight of the atmosphere</p>
</dd>
<dt>mfp<span class="classifier">float</span></dt><dd><p>atmospheric mean free path (cm)</p>
</dd>
<dt>visc<span class="classifier">float</span></dt><dd><p>atmospheric viscosity (dyne s/cm^2)</p>
</dd>
<dt>rho_p<span class="classifier">float</span></dt><dd><p>density of condensed vapor (g/cm^3)</p>
</dd>
<dt>w_convect<span class="classifier">float</span></dt><dd><p>convective velocity scale (cm/s)</p>
</dd>
<dt>fsed<span class="classifier">float</span></dt><dd><p>Sedimentation efficiency coefficient (unitless)</p>
</dd>
<dt>b<span class="classifier">float</span></dt><dd><p>Denominator of exponential in sedimentation efficiency  (if param is ‘exp’)</p>
</dd>
<dt>eps: float</dt><dd><p>Minimum value of fsed function (if param=exp)</p>
</dd>
<dt>z_bot<span class="classifier">float</span></dt><dd><p>Altitude at bottom of layer</p>
</dd>
<dt>z_layer<span class="classifier">float</span></dt><dd><p>Altitude of midpoint of layer (cm)</p>
</dd>
<dt>z_alpha<span class="classifier">float</span></dt><dd><p>Altitude at which fsed=alpha for variable fsed calculation</p>
</dd>
<dt>param<span class="classifier">str</span></dt><dd><p>fsed parameterisation
‘const’ (constant), ‘exp’ (exponential density derivation)</p>
</dd>
<dt>sig<span class="classifier">float</span></dt><dd><p>Width of the log normal particle distrubtion</p>
</dd>
<dt>mh<span class="classifier">float</span></dt><dd><p>Metallicity NON log solar (1 = 1x solar)</p>
</dd>
<dt>rmin<span class="classifier">float</span></dt><dd><p>Minium radius on grid (cm)</p>
</dd>
<dt>nrad<span class="classifier">int</span></dt><dd><p>Number of radii on Mie grid</p>
</dd>
<dt>radius<span class="classifier">ndarray</span></dt><dd><p>Particle radius bin centers from the grid (cm)</p>
</dd>
<dt>aggregates<span class="classifier">bool, optional</span></dt><dd><p>set to ‘True’ if you want fractal aggregates, keep at default ‘False’ for spherical cloud particles</p>
</dd>
<dt>Df<span class="classifier">float, optional</span></dt><dd><p>only used if aggregate = True.
The fractal dimension of an aggregate particle.
Low Df are highly fractal long, lacy chains; large Df are more compact. Df = 3 is a perfect compact sphere.</p>
</dd>
<dt>N_mon<span class="classifier">float, optional</span></dt><dd><p>only used if aggregate = True.
The number of monomers that make up the aggregate. Either this OR r_mon should be provided (but not both).</p>
</dd>
<dt>r_mon<span class="classifier">float, optional (units: cm)</span></dt><dd><p>only used if aggregate = True.
The size of the monomer radii (sub-particles) that make up the aggregate. Either this OR N_mon should be
provided (but not both).</p>
</dd>
<dt>k0<span class="classifier">float, optional (units: None)</span></dt><dd><p>only used if aggregate = True.
Default = 0, where it will then be calculated in the vfall equation using Tazaki (2021) Eq 2. k0 can also be prescribed by user,
but with a warning that when r_mon is fixed, unless d_f = 1 at r= r_mon, the dynamics may not be consistent between the boundary
when spheres grow large enough to become aggregates (this applies only when r_mon is fixed. If N_mon is fixed instead, any value of k0 is fine).</p>
</dd>
<dt>og_vfall<span class="classifier">bool , optional</span></dt><dd><p>optional, default = True. True does the original fall velocity calculation.
False does the updated one which runs a tad slower but is more consistent.
The main effect of turning on False is particle sizes in the upper atmosphere
that are slightly bigger.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>qt_top</strong> (<em>float</em>) – gas + condensate mixing ratio at top of layer(g/g)</p></li>
<li><p><strong>qc_layer</strong> (<em>float</em>) – condenstate mixing ratio (g/g)</p></li>
<li><p><strong>qt_layer</strong> (<em>float</em>) – gas + condensate mixing ratio (g/g)</p></li>
<li><p><strong>rg_layer</strong> (<em>float</em>) – geometric mean radius of condensate  cm</p></li>
<li><p><strong>reff_layer</strong> (<em>float</em>) – droplet effective radius (second moment of size distrib, cm)</p></li>
<li><p><strong>ndz_layer</strong> (<em>float</em>) – number column density of condensate (cm^-3)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justdoit.compute">
<span class="sig-prename descclassname"><span class="pre">virga.justdoit.</span></span><span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atmo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">og_solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_TP</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">og_vfall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analytical_rg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_virtual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.compute" title="Link to this definition"></a></dt>
<dd><p>Top level program to run eddysed. Requires running <cite>Atmosphere</cite> class
before running this.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmo</strong> (<em>class</em>) – <cite>Atmosphere</cite> class</p></li>
<li><p><strong>directory</strong> (<em>str</em><em>, </em><em>optional</em>) – Directory string that describes where refrind files are</p></li>
<li><p><strong>as_dict</strong> (<em>bool</em><em>, </em><em>optional</em>) – Default = False. Option to view full output as dictionary</p></li>
<li><p><strong>og_solver</strong> (<em>bool</em><em>, </em><em>optional</em>) – <dl class="simple">
<dt>Default=True. BETA. Contact developers before changing to False.</dt><dd><p>Option to change mmr solver (True = original eddysed, False = new direct solver)</p>
</dd>
</dl>
</p></li>
<li><p><strong>direct_tol</strong> (<em>float</em><em> , </em><em>optional</em>) – Only used if og_solver =False. Default = True.
Tolerance for direct solver</p></li>
<li><p><strong>refine_TP</strong> (<em>bool</em><em>, </em><em>optional</em>) – Only used if og_solver =False.
Option to refine temperature-pressure profile for direct solver</p></li>
<li><p><strong>og_vfall</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to use original A&amp;M or new Khan-Richardson method for finding vfall</p></li>
<li><p><strong>analytical_rg</strong> (<em>bool</em><em>, </em><em>optional</em>) – Only used if og_solver =False.
Option to use analytical expression for rg, or alternatively deduce rg from calculation
Calculation option will be most useful for future
inclusions of alternative particle size distributions</p></li>
<li><p><strong>do_virtual</strong> (<em>bool</em>) – If the user adds an upper bound pressure that is too low. There are cases where a cloud wants to
form off the grid towards higher pressures. This enables that.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>opd, w0, g0</em> – Extinction per layer, single scattering abledo, asymmetry parameter,
All are ndarrays that are nlayer by nwave</p></li>
<li><p><em>dict</em> – Dictionary output that contains full output. See tutorials for explanation of all output.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justdoit.condensation_t">
<span class="sig-prename descclassname"><span class="pre">virga.justdoit.</span></span><span class="sig-name descname"><span class="pre">condensation_t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gas_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([1.00000000e-06,</span> <span class="pre">2.63665090e-06,</span> <span class="pre">6.95192796e-06,</span> <span class="pre">1.83298071e-05,</span> <span class="pre">4.83293024e-05,</span> <span class="pre">1.27427499e-04,</span> <span class="pre">3.35981829e-04,</span> <span class="pre">8.85866790e-04,</span> <span class="pre">2.33572147e-03,</span> <span class="pre">6.15848211e-03,</span> <span class="pre">1.62377674e-02,</span> <span class="pre">4.28133240e-02,</span> <span class="pre">1.12883789e-01,</span> <span class="pre">2.97635144e-01,</span> <span class="pre">7.84759970e-01,</span> <span class="pre">2.06913808e+00,</span> <span class="pre">5.45559478e+00,</span> <span class="pre">1.43844989e+01,</span> <span class="pre">3.79269019e+01,</span> <span class="pre">1.00000000e+02])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_mmr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.condensation_t" title="Link to this definition"></a></dt>
<dd><p>Find condensation curve for any planet given a pressure. These are computed
based on pressure vapor curves defined in pvaps.py.</p>
<p>Default is to compute condensation temperature on a pressure grid</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gas_name</strong> (<em>str</em>) – Name of gas, which is case sensitive. See print_available to see which
gases are available.</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – Metallicity in NOT log units. Solar =1</p></li>
<li><p><strong>mmw</strong> (<em>float</em>) – Mean molecular weight of the atmosphere. Solar = 2.2</p></li>
<li><p><strong>pressure</strong> (<em>ndarray</em><em>, </em><em>list</em><em>, </em><em>float</em><em>, </em><em>optional</em>) – Grid of pressures (bars) to compute condensation temperatures on.
Default = np.logspace(-3,2,20)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pressure (bars), condensation temperature (Kelvin)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justdoit.convert_refrind_to_lnk">
<span class="sig-prename descclassname"><span class="pre">virga.justdoit.</span></span><span class="sig-name descname"><span class="pre">convert_refrind_to_lnk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aggregate_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">virga_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optool_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.convert_refrind_to_lnk" title="Link to this definition"></a></dt>
<dd><p>Converts VIRGA’s .refrind files into OPTOOL .lnk files. The differences in file format are below:</p>
<blockquote>
<div><p>VIRGA: [index,  wavelength,  n,  k]     No header, and in order of descending wavelength</p>
<p>OPTOOL: [wavelength,  n,  k]     Header (num wavelengths and density, can also include comments), and in order of ascending wavelength</p>
</div></blockquote>
<p>This function converts the XX.refrind file and saves it in the OPTOOL folder as XX_VIRGA.lnk in the optool directory, ready for optool to
use in MMF calculations (see “calc_mie_db”).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>aggregate_list</strong> (<em>list</em><em>, </em><em>str</em>) – List of names of gasses. Or a single gas name.
See pyeddy.available() to see which ones are currently available.</p></li>
<li><p><strong>virga_dir</strong> (<em>str</em>) – Directory where you store the VIRGA refractive index files (.refind format).</p></li>
<li><p><strong>optool_dir</strong> (<em>str</em>) – Directory where you store optool refractive index files (.lnk format).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justdoit.create_dict">
<span class="sig-prename descclassname"><span class="pre">virga.justdoit.</span></span><span class="sig-name descname"><span class="pre">create_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opd_gas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fsed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_radii</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz_layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mixl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_cld</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.create_dict" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justdoit.eddysed">
<span class="sig-prename descclassname"><span class="pre">virga.justdoit.</span></span><span class="sig-name descname"><span class="pre">eddysed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_top</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_top</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_mid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_mid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">condensibles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_mw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_mmr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mw_atmos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gravity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mixl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fsed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_top</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_p_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_mon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_mon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">og_vfall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_virtual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supsat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.eddysed" title="Link to this definition"></a></dt>
<dd><p>Given an atmosphere and condensates, calculate size and concentration
of condensates in balance between eddy diffusion and sedimentation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t_top</strong> (<em>ndarray</em>) – Temperature at each layer (K)</p></li>
<li><p><strong>p_top</strong> (<em>ndarray</em>) – Pressure at each layer (dyn/cm^2)</p></li>
<li><p><strong>t_mid</strong> (<em>ndarray</em>) – Temperature at each midpoint (K)</p></li>
<li><p><strong>p_mid</strong> (<em>ndarray</em>) – Pressure at each midpoint (dyn/cm^2)</p></li>
<li><p><strong>condensibles</strong> (<em>ndarray</em><em> or </em><em>list</em><em> of </em><em>str</em>) – List or array of condensible gas names</p></li>
<li><p><strong>gas_mw</strong> (<em>ndarray</em>) – Array of gas mean molecular weight from <cite>gas_properties</cite></p></li>
<li><p><strong>gas_mmr</strong> (<em>ndarray</em>) – Array of gas mixing ratio from <cite>gas_properties</cite></p></li>
<li><p><strong>rho_p</strong> (<em>float</em>) – density of condensed vapor (g/cm^3)</p></li>
<li><p><strong>mw_atmos</strong> (<em>float</em>) – Mean molecular weight of the atmosphere</p></li>
<li><p><strong>gravity</strong> (<em>float</em>) – Gravity of planet cgs</p></li>
<li><p><strong>kz</strong> (<em>float</em><em> or </em><em>ndarray</em>) – Kzz in cgs, either float or ndarray depending of whether or not
it is set as input</p></li>
<li><p><strong>fsed</strong> (<em>float</em>) – Sedimentation efficiency coefficient, unitless</p></li>
<li><p><strong>b</strong> (<em>float</em>) – Denominator of exponential in sedimentation efficiency  (if param is ‘exp’)</p></li>
<li><p><strong>eps</strong> (<em>float</em>) – Minimum value of fsed function (if param=exp)</p></li>
<li><p><strong>scale_h</strong> (<em>float</em>) – Scale height of the atmosphere</p></li>
<li><p><strong>z_top</strong> (<em>float</em>) – Altitude at each layer</p></li>
<li><p><strong>z_alpha</strong> (<em>float</em>) – Altitude at which fsed=alpha for variable fsed calculation</p></li>
<li><p><strong>param</strong> (<em>str</em>) – fsed parameterisation
‘const’ (constant), ‘exp’ (exponential density derivation)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – Atmospheric metallicity in NON log units (e.g. 1 for 1x solar)</p></li>
<li><p><strong>sig</strong> (<em>float</em>) – Width of the log normal particle distribution</p></li>
<li><p><strong>rmin</strong> (<em>float</em>) – Minium radius on grid (cm)</p></li>
<li><p><strong>nrad</strong> (<em>int</em>) – Number of radii on Mie grid</p></li>
<li><p><strong>radius</strong> (<em>ndarray</em>) – Particle radius bin centers from the grid (cm)</p></li>
<li><p><strong>d_molecule</strong> (<em>float</em>) – diameter of atmospheric molecule (cm) (Rosner, 2000)
(3.711e-8 for air, 3.798e-8 for N2, 2.827e-8 for H2)
Set in Atmosphere constants</p></li>
<li><p><strong>eps_k</strong> (<em>float</em>) – Depth of the Lennard-Jones potential well for the atmosphere
Used in the viscocity calculation (units are K) (Rosner, 2000)</p></li>
<li><p><strong>c_p_factor</strong> (<em>float</em>) – specific heat of atmosphere (erg/K/g) . Usually 7/2 for ideal gas
diatomic molecules (e.g. H2, N2). Technically does slowly rise with
increasing temperature</p></li>
<li><p><strong>aggregates</strong> (<em>bool</em><em>, </em><em>optional</em>) – set to ‘True’ if you want fractal aggregates, keep at default ‘False’ for spherical cloud particles</p></li>
<li><p><strong>Df</strong> (<em>float</em><em>, </em><em>optional</em>) – only used if aggregate = True.
The fractal dimension of an aggregate particle.
Low Df are highly fractal long, lacy chains; large Df are more compact. Df = 3 is a perfect compact sphere.</p></li>
<li><p><strong>N_mon</strong> (<em>float</em><em>, </em><em>optional</em>) – only used if aggregate = True.
The number of monomers that make up the aggregate. Either this OR r_mon should be provided (but not both).</p></li>
<li><p><strong>r_mon</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>units: cm</em><em>)</em>) – only used if aggregate = True.
The size of the monomer radii (sub-particles) that make up the aggregate. Either this OR N_mon should be
provided (but not both).</p></li>
<li><p><strong>k0</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>units: None</em><em>)</em>) – only used if aggregate = True.
Default = 0, where it will then be calculated in the vfall equation using Tazaki (2021) Eq 2. k0 can also be prescribed by user,
but with a warning that when r_mon is fixed, unless d_f = 1 at r= r_mon, the dynamics may not be consistent between the boundary
when spheres grow large enough to become aggregates (this applies only when r_mon is fixed. If N_mon is fixed instead, any value of k0 is fine).</p></li>
<li><p><strong>og_vfall</strong> (<em>bool</em><em> , </em><em>optional</em>) – optional, default = True. True does the original fall velocity calculation.
False does the updated one which runs a tad slower but is more consistent.
The main effect of turning on False is particle sizes in the upper atmosphere
that are slightly bigger.</p></li>
<li><p><strong>do_virtual</strong> (<em>bool</em><em>,</em><em>optional</em>) – optional, Default = True which adds a virtual layer if the
species condenses below the model domain.</p></li>
<li><p><strong>supsat</strong> (<em>float</em><em>, </em><em>optional</em>) – Default = 0 , Saturation factor (after condensation)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>qc</strong> (<em>ndarray</em>) – condenstate mixing ratio (g/g)</p></li>
<li><p><strong>qt</strong> (<em>ndarray</em>) – gas + condensate mixing ratio (g/g)</p></li>
<li><p><strong>rg</strong> (<em>ndarray</em>) – geometric mean radius of condensate  cm</p></li>
<li><p><strong>reff</strong> (<em>ndarray</em>) – droplet effective radius (second moment of size distrib, cm)</p></li>
<li><p><strong>ndz</strong> (<em>ndarray</em>) – number column density of condensate (cm^-3)</p></li>
<li><p><strong>qc_path</strong> (<em>ndarray</em>) – vertical path of condensate</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justdoit.get_mie">
<span class="sig-prename descclassname"><span class="pre">virga.justdoit.</span></span><span class="sig-name descname"><span class="pre">get_mie</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.get_mie" title="Link to this definition"></a></dt>
<dd><p>Get pre-calculated radius-wavelength grid of optical properties, considering the particles as either spheres (gas_name.mieff)
or aggregates (gas_name_aggregates_Df_XXXX.mieff), if aggregates=true and this aggregates file has been created using calc_mie_db function).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justdoit.get_r_grid">
<span class="sig-prename descclassname"><span class="pre">virga.justdoit.</span></span><span class="sig-name descname"><span class="pre">get_r_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.054239131</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_radii</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.get_r_grid" title="Link to this definition"></a></dt>
<dd><p>New version of grid generator - creates lin-spaced or log-spaced radii grids. Updated by MGL 07/01/25.</p>
<p>ALGORITHM DESCRIPTION:</p>
<p>First, VIRGA makes grid of particle sizes and calculates the optical properties for them. Then, when we find the average particle
size in a particular layer of cloud, it creates a lognormal distribution of particles (one that has the calculated mean radius),
and then finds how many particles fall into each of the ‘bins’ of the radius ‘grid’ that we have created. Finally, it weights the
contribution from each bin by the number of particles to calculate the total opacity of that layer. Therefore, the same grid needs
to be used for making the .mieff files (optical properties) and running VIRGA.</p>
<p>This new version simplifies the arrays to represent the mean, minimum and maximum values of radius in each bin. It also uses a consistent
function to calculate the radius values and bin widths, as well as correcting an error for the first bin mean.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r_min</strong> (<em>float</em>) – minimum radius in grid (in cm). Default is 10^-8 cm (0.0001 um) to match databases in v0.0.</p></li>
<li><p><strong>r_max</strong> (<em>float</em>) – maximum radius in grid (in cm). Default is 5.4239131 x 10^-2 cm (542 um), to match databases in v0.0.</p></li>
<li><p><strong>n_radii</strong> (<em>int</em>) – number of increments (note that each of these increments will be further divided into 6 sub-bins to smooth out any resonance features that occur due to specific particle sizes). Default is 60 to match databases in v0.0.</p></li>
<li><p><strong>logspace</strong> (<em>boolean</em>) – Default = True. Spaces the radii logarithmically if True (tends to be the case in the clouds). Spaces them linearly if False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>radius</strong> (<em>array</em>) – the mean radii for each set of 6 sub-bins</p></li>
<li><p><strong>bin_min</strong> (<em>array</em>) – minimum value of each bin</p></li>
<li><p><em>bin_max</em> – maximum value of each bin</p></li>
<li><p><strong>dr</strong> (<em>array</em>) – the difference between the start and end of each bin (width of the radius bin)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justdoit.get_r_grid_legacy">
<span class="sig-prename descclassname"><span class="pre">virga.justdoit.</span></span><span class="sig-name descname"><span class="pre">get_r_grid_legacy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_radii</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.get_r_grid_legacy" title="Link to this definition"></a></dt>
<dd><p>Original code from A&amp;M code.
Discontinued function. See ‘get_r_grid()’.</p>
<section id="of-the-reasons-it-was-discontinued">
<h3>of the reasons it was discontinued.)<a class="headerlink" href="#of-the-reasons-it-was-discontinued" title="Link to this heading"></a></h3>
<p>Get spacing of radii to run Mie code</p>
<dl class="simple">
<dt>r_min<span class="classifier">float</span></dt><dd><p>Minimum radius to compute (cm)</p>
</dd>
<dt>n_radii<span class="classifier">int</span></dt><dd><p>Number of radii to compute</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justdoit.get_r_grid_w_max">
<span class="sig-prename descclassname"><span class="pre">virga.justdoit.</span></span><span class="sig-name descname"><span class="pre">get_r_grid_w_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.054239131</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_radii</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.get_r_grid_w_max" title="Link to this definition"></a></dt>
<dd><p>Discontinued function. See ‘get_r_grid()’.</p>
<section id="id11">
<h3>of the reasons it was discontinued.)<a class="headerlink" href="#id11" title="Link to this heading"></a></h3>
<p>Get spacing of radii to run Mie code</p>
<dl class="simple">
<dt>r_min<span class="classifier">float</span></dt><dd><p>Minimum radius to compute (cm)</p>
</dd>
<dt>r_max<span class="classifier">float</span></dt><dd><p>Maximum radius to compute (cm)</p>
</dd>
<dt>n_radii<span class="classifier">int</span></dt><dd><p>Number of radii to compute</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justdoit.get_refrind">
<span class="sig-prename descclassname"><span class="pre">virga.justdoit.</span></span><span class="sig-name descname"><span class="pre">get_refrind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">igas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.get_refrind" title="Link to this definition"></a></dt>
<dd><p>Reads reference files with wavelength, and refractory indicies. The file formats
are different for VIRGA and OPTOOL. OPTOOL formats should be created by the user
and stored in /lnk_data using the “convert_refrind_to_lnk function before running
“calc_mie_db” function</p>
<p>VIRGA FILE FORMAT:
Input files are structured as a 4 column file with columns:
index, wavelength (micron), nn, kk</p>
<p>OPTOOL FILE FORMAT:
Input files are structured as a 3 column file with columns:
wavelength (micron), nn, kk</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>igas</strong> (<em>str</em>) – Gas name</p></li>
<li><p><strong>directory</strong> (<em>str</em>) – Directory were reference files are located.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>wavelength, real part, imaginary part</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justdoit.hot_jupiter">
<span class="sig-prename descclassname"><span class="pre">virga.justdoit.</span></span><span class="sig-name descname"><span class="pre">hot_jupiter</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.hot_jupiter" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justdoit.layer">
<span class="sig-prename descclassname"><span class="pre">virga.justdoit.</span></span><span class="sig-name descname"><span class="pre">layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gas_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_top</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_bot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_top</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_bot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mixl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gravity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mw_atmos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_mw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_below</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supsat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fsed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_top</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_bot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_p_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">og_vfall</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_cld</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_mon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_mon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.layer" title="Link to this definition"></a></dt>
<dd><p>Calculate layer condensate properties by iterating on optical depth
in one model layer (converging on optical depth over sublayers)</p>
<dl class="simple">
<dt>gas_name<span class="classifier">str</span></dt><dd><p>Name of condenstante</p>
</dd>
<dt>rho_p<span class="classifier">float</span></dt><dd><p>density of condensed vapor (g/cm^3)</p>
</dd>
<dt>t_layer<span class="classifier">float</span></dt><dd><p>Temperature of layer mid-pt (K)</p>
</dd>
<dt>p_layer<span class="classifier">float</span></dt><dd><p>Pressure of layer mid-pt (dyne/cm^2)</p>
</dd>
<dt>t_top<span class="classifier">float</span></dt><dd><p>Temperature at top of layer (K)</p>
</dd>
<dt>t_bot<span class="classifier">float</span></dt><dd><p>Temperature at botton of layer (K)</p>
</dd>
<dt>p_top<span class="classifier">float</span></dt><dd><p>Pressure at top of layer (dyne/cm2)</p>
</dd>
<dt>p_bot<span class="classifier">float</span></dt><dd><p>Pressure at botton of layer</p>
</dd>
<dt>kz<span class="classifier">float</span></dt><dd><p>eddy diffusion coefficient (cm^2/s)</p>
</dd>
<dt>mixl<span class="classifier">float</span></dt><dd><p>Mixing length (cm)</p>
</dd>
<dt>gravity<span class="classifier">float</span></dt><dd><p>Gravity of planet cgs</p>
</dd>
<dt>mw_atmos<span class="classifier">float</span></dt><dd><p>Molecular weight of the atmosphere</p>
</dd>
<dt>gas_mw<span class="classifier">float</span></dt><dd><p>Gas molecular weight</p>
</dd>
<dt>q_below<span class="classifier">float</span></dt><dd><p>total mixing ratio (vapor+condensate) below layer (g/g)</p>
</dd>
<dt>supsat<span class="classifier">float</span></dt><dd><p>Super saturation factor</p>
</dd>
<dt>fsed<span class="classifier">float</span></dt><dd><p>Sedimentation efficiency coefficient (unitless)</p>
</dd>
<dt>b<span class="classifier">float</span></dt><dd><p>Denominator of exponential in sedimentation efficiency  (if param is ‘exp’)</p>
</dd>
<dt>eps: float</dt><dd><p>Minimum value of fsed function (if param=exp)</p>
</dd>
<dt>z_top<span class="classifier">float</span></dt><dd><p>Altitude at top of layer</p>
</dd>
<dt>z_bot<span class="classifier">float</span></dt><dd><p>Altitude at bottom of layer</p>
</dd>
<dt>z_alpha<span class="classifier">float</span></dt><dd><p>Altitude at which fsed=alpha for variable fsed calculation</p>
</dd>
<dt>param<span class="classifier">str</span></dt><dd><p>fsed parameterisation
‘const’ (constant), ‘exp’ (exponential density derivation)</p>
</dd>
<dt>sig<span class="classifier">float</span></dt><dd><p>Width of the log normal particle distribution</p>
</dd>
<dt>mh<span class="classifier">float</span></dt><dd><p>Metallicity NON log soar (1=1xSolar)</p>
</dd>
<dt>rmin<span class="classifier">float</span></dt><dd><p>Minium radius on grid (cm)</p>
</dd>
<dt>nrad<span class="classifier">int</span></dt><dd><p>Number of radii on Mie grid</p>
</dd>
<dt>radius<span class="classifier">ndarray</span></dt><dd><p>Particle radius bin centers from the grid (cm)</p>
</dd>
<dt>d_molecule<span class="classifier">float</span></dt><dd><p>diameter of atmospheric molecule (cm) (Rosner, 2000)
(3.711e-8 for air, 3.798e-8 for N2, 2.827e-8 for H2)
Set in Atmosphere constants</p>
</dd>
<dt>eps_k<span class="classifier">float</span></dt><dd><p>Depth of the Lennard-Jones potential well for the atmosphere
Used in the viscocity calculation (units are K) (Rosner, 2000)</p>
</dd>
<dt>c_p_factor<span class="classifier">float</span></dt><dd><p>specific heat of atmosphere (erg/K/g) . Usually 7/2 for ideal gas
diatomic molecules (e.g. H2, N2). Technically does slowly rise with
increasing temperature</p>
</dd>
<dt>og_vfall<span class="classifier">bool</span></dt><dd><p>Use original or new vfall calculation</p>
</dd>
<dt>aggregates<span class="classifier">bool, optional</span></dt><dd><p>set to ‘True’ if you want fractal aggregates, keep at default ‘False’ for spherical cloud particles</p>
</dd>
<dt>Df<span class="classifier">float, optional</span></dt><dd><p>only used if aggregate = True.
The fractal dimension of an aggregate particle.
Low Df are highly fractal long, lacy chains; large Df are more compact. Df = 3 is a perfect compact sphere.</p>
</dd>
<dt>N_mon<span class="classifier">float, optional</span></dt><dd><p>only used if aggregate = True.
The number of monomers that make up the aggregate. Either this OR r_mon should be provided (but not both).</p>
</dd>
<dt>k0<span class="classifier">float, optional (units: None)</span></dt><dd><p>only used if aggregate = True.
Default = 0, where it will then be calculated in the vfall equation using Tazaki (2021) Eq 2. k0 can also be prescribed by user,
but with a warning that when r_mon is fixed, unless d_f = 1 at r= r_mon, the dynamics may not be consistent between the boundary
when spheres grow large enough to become aggregates (this applies only when r_mon is fixed. If N_mon is fixed instead, any value of k0 is fine).</p>
</dd>
<dt>r_mon<span class="classifier">float, optional (units: cm)</span></dt><dd><p>only used if aggregate = True.
The size of the monomer radii (sub-particles) that make up the aggregate. Either this OR N_mon should be
provided (but not both).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>qc_layer</strong> (<em>ndarray</em>) – condenstate mixing ratio (g/g)</p></li>
<li><p><strong>qt_layer</strong> (<em>ndarray</em>) – gas + condensate mixing ratio (g/g)</p></li>
<li><p><strong>rg_layer</strong> (<em>ndarray</em>) – geometric mean radius of condensate  cm</p></li>
<li><p><strong>reff_layer</strong> (<em>ndarray</em>) – droplet effective radius (second moment of size distrib, cm)</p></li>
<li><p><strong>ndz_layer</strong> (<em>ndarray</em>) – number column density of condensate (cm^-3)</p></li>
<li><p><strong>q_below</strong> (<em>ndarray</em>) – total mixing ratio (vapor+condensate) below layer (g/g)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justdoit.picaso_format">
<span class="sig-prename descclassname"><span class="pre">virga.justdoit.</span></span><span class="sig-name descname"><span class="pre">picaso_format</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavenumber</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.picaso_format" title="Link to this definition"></a></dt>
<dd><p>Gets virga output to picaso format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>opd</strong> (<em>ndarray</em>) – array from virga of extinction optical depths per layer</p></li>
<li><p><strong>w0</strong> (<em>ndarray</em>) – array from virga of single scattering albedo</p></li>
<li><p><strong>g0</strong> (<em>ndarray</em>) – array from virga of asymmetry</p></li>
<li><p><strong>pressure</strong> (<em>array</em>) – pressure array in bars</p></li>
<li><p><strong>wavenumber</strong> (<em>array</em>) – wavenumber arry in cm^(-1)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justdoit.picaso_format_custom_wavenumber_grid">
<span class="sig-prename descclassname"><span class="pre">virga.justdoit.</span></span><span class="sig-name descname"><span class="pre">picaso_format_custom_wavenumber_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavenumber_grid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.picaso_format_custom_wavenumber_grid" title="Link to this definition"></a></dt>
<dd><p>This is currently redundant with picaso_format now that picaso_format
reads in wavenumber grid.
Keeping for now, but will discontinue soon.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justdoit.picaso_format_slab">
<span class="sig-prename descclassname"><span class="pre">virga.justdoit.</span></span><span class="sig-name descname"><span class="pre">picaso_format_slab</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_bottom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavenumber_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.picaso_format_slab" title="Link to this definition"></a></dt>
<dd><p>Sets up a PICASO-readable dataframe that inserts a wavelength dependent aerosol layer at the user’s
given pressure bounds, i.e., a wavelength-dependent slab of clouds or haze.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p_bottom</strong> (<em>float</em>) – the cloud/haze base pressure
the upper bound of pressure (i.e., lower altitude bound) to set the aerosol layer. (Bars)</p></li>
<li><p><strong>opd</strong> (<em>ndarray</em>) – wavelength-dependent optical depth of the aerosol</p></li>
<li><p><strong>w0</strong> (<em>ndarray</em>) – wavelength-dependent single scattering albedo of the aerosol</p></li>
<li><p><strong>g0</strong> (<em>ndarray</em>) – asymmetry parameter = Q_scat wtd avg of &lt;cos theta&gt;</p></li>
<li><p><strong>wavenumber_grid</strong> (<em>ndarray</em>) – wavenumber grid in (cm^-1)</p></li>
<li><p><strong>pressure_grid</strong> (<em>ndarray</em>) – bars, user-defined pressure grid for the model atmosphere</p></li>
<li><p><strong>p_top</strong> (<em>float</em>) – bars, the cloud/haze-top pressure
This cuts off the upper cloud region as a step function.
You must specify either p_top or p_decay.</p></li>
<li><p><strong>p_decay</strong> (<em>ndarray</em>) – noramlized to 1, unitless
array the same size as pressure_grid which specifies a
height dependent optical depth. The usual format of p_decay is
a fsed like exponential decay ~np.exp(-fsed*z/H)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe of aerosol layer with pressure (in levels - non-physical units!), wavenumber, opd, w0, and g0 to be read by PICASO</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justdoit.recommend_gas">
<span class="sig-prename descclassname"><span class="pre">virga.justdoit.</span></span><span class="sig-name descname"><span class="pre">recommend_gas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pressure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returnplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'inside'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">plot_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.recommend_gas" title="Link to this definition"></a></dt>
<dd><p>Recommends condensate species for a users calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pressure</strong> (<em>ndarray</em><em>, </em><em>list</em>) – Pressure grid for user’s pressure-temperature profile. Unit=bars</p></li>
<li><p><strong>temperature</strong> (<em>ndarray</em><em>, </em><em>list</em>) – Temperature grid (should be on same grid as pressure input). Unit=Kelvin</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – Metallicity in NOT log units. Solar =1</p></li>
<li><p><strong>mmw</strong> (<em>float</em>) – Mean molecular weight of the atmosphere. Solar = 2.2</p></li>
<li><p><strong>plot</strong> (<em>bool</em><em>, </em><em>optional</em>) – Default is False. Plots condensation curves against PT profile to
demonstrate why it has chose the gases it did.</p></li>
<li><p><strong>plot_kwargs</strong> (<em>kwargs</em>) – Plotting kwargs for bokeh figure</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pressure (bars), condensation temperature (Kelvin)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justdoit.temperate_neptune">
<span class="sig-prename descclassname"><span class="pre">virga.justdoit.</span></span><span class="sig-name descname"><span class="pre">temperate_neptune</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.temperate_neptune" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justdoit.warm_neptune">
<span class="sig-prename descclassname"><span class="pre">virga.justdoit.</span></span><span class="sig-name descname"><span class="pre">warm_neptune</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.warm_neptune" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-virga.justplotit">
<span id="virga-justplotit-module"></span><h2>virga.justplotit module<a class="headerlink" href="#module-virga.justplotit" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="virga.justplotit.aggregates_optical_properties">
<span class="sig-prename descclassname"><span class="pre">virga.justplotit.</span></span><span class="sig-name descname"><span class="pre">aggregates_optical_properties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aggregate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mieff_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_f_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_wavelength</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_wavelength</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justplotit.aggregates_optical_properties" title="Link to this definition"></a></dt>
<dd><p>Code to plot the optical properties calculated in the .mieff files. for all radii and fractal dimensions analysed.</p>
<p>Plots a 3D graph of Q_ext against wavelength (um) for all fractal dimensions (third axis).</p>
<p>Set filtered = True if you want a smoother curve (using a savgol filter) for easier comparison of different fractals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>aggregate</strong> (<em>string</em>) – chemical species used in model</p></li>
<li><p><strong>mieff_dir</strong> (<em>string</em>) – filepath to directory where .mieff files are stored</p></li>
<li><p><strong>d_f_list</strong> (<em>array</em>) – list of fractal dimensions analysed</p></li>
<li><p><strong>min_wavelength</strong> (<em>float</em>) – minimum wavelength to plot</p></li>
<li><p><strong>max_wavelength</strong> (<em>float</em>) – maximum wavelength to plot</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>3D graph of Q_ext against wavelength (um) for all fractal dimensions (third axis).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justplotit.aggregates_pressure_vs_number_density">
<span class="sig-prename descclassname"><span class="pre">virga.justplotit.</span></span><span class="sig-name descname"><span class="pre">aggregates_pressure_vs_number_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clouds_from_virga_spheres</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clouds_from_virga_fractals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_f_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_pressure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_pressure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justplotit.aggregates_pressure_vs_number_density" title="Link to this definition"></a></dt>
<dd><p>Code to plot the particle densities at each radius and at each pressure layer for aggregates of each fractal dimension.
This basically allows you to see the relative numbers and radii of the particles that form in each layer, for each fractal dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clouds_from_virga_spheres</strong> (<em>dict</em>) – output from virga (spherical model)</p></li>
<li><p><strong>clouds_from_virga_fractals</strong> (<em>dict</em>) – array of dicts with output from virga (all of the virga models for each fractal dimension)</p></li>
<li><p><strong>d_f_list</strong> (<em>array</em>) – list of fractal dimensions analysed</p></li>
<li><p><strong>colors</strong> (<em>array</em><em> (</em><em>optional</em><em>)</em>) – list of colors to use (in order: spheres, 1.2, 1.6, 2.0, 2.4, 2.8)</p></li>
<li><p><strong>min_pressure</strong> (<em>float</em><em> (</em><em>optional</em><em>)</em>) – minimum pressure (bars) to plot on y-axis</p></li>
<li><p><strong>max_pressure</strong> (<em>float</em><em> (</em><em>optional</em><em>)</em>) – maximum pressure (bars) to plot on y-axis</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Figure with the particle densities at each radius and at each pressure layer for aggregates of each fractal dimension</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justplotit.aggregates_pressure_vs_radius">
<span class="sig-prename descclassname"><span class="pre">virga.justplotit.</span></span><span class="sig-name descname"><span class="pre">aggregates_pressure_vs_radius</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clouds_from_virga_spheres</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clouds_from_virga_fractals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_f_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_pressure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_pressure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justplotit.aggregates_pressure_vs_radius" title="Link to this definition"></a></dt>
<dd><p>Code to plot the particle radius at each pressure layer for aggregates of each fractal dimension.
Designed originally for diagnostic tests as part for VIRGA development by MGL.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clouds_from_virga_spheres</strong> (<em>dict</em>) – output from virga (spherical model)</p></li>
<li><p><strong>clouds_from_virga_fractals</strong> (<em>dict</em>) – array of dicts with output from virga (all of the virga models for each fractal dimension)</p></li>
<li><p><strong>d_f_list</strong> (<em>array</em>) – list of fractal dimensions analysed</p></li>
<li><p><strong>colors</strong> (<em>array</em><em> (</em><em>optional</em><em>)</em>) – list of colors to use (in order: spheres, 1.2, 1.6, 2.0, 2.4, 2.8)</p></li>
<li><p><strong>width</strong> (<em>float</em><em> (</em><em>optional</em><em>)</em>) – width of lines in plot (default = 3)</p></li>
<li><p><strong>min_pressure</strong> (<em>float</em><em> (</em><em>optional</em><em>)</em>) – minimum pressure (bars) to plot on y-axis</p></li>
<li><p><strong>max_pressure</strong> (<em>float</em><em> (</em><em>optional</em><em>)</em>) – maximum pressure (bars) to plot on y-axis</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Figure plotting the particle radius at each pressure layer for aggregates of each fractal dimension.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justplotit.aggregates_wavelength_radius_grid">
<span class="sig-prename descclassname"><span class="pre">virga.justplotit.</span></span><span class="sig-name descname"><span class="pre">aggregates_wavelength_radius_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clouds_from_virga_spheres</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clouds_from_virga_fractals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_f_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mieff_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justplotit.aggregates_wavelength_radius_grid" title="Link to this definition"></a></dt>
<dd><p>Code to plot the wavelength-radius grid that was used the create the .mieff files, and then overplot the actual radii
for each pressure layer for each fractal dimension, so that we can check that the radii we are using actually have
unique optical properties that were calculated at a reasonable resolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clouds_from_virga_spheres</strong> (<em>dict</em>) – output from virga (spherical model)</p></li>
<li><p><strong>clouds_from_virga_fractals</strong> (<em>dict</em>) – array of dicts with output from virga (all of the virga models for each fractal dimension)</p></li>
<li><p><strong>aggregate</strong> (<em>string</em>) – chemical species used in model</p></li>
<li><p><strong>d_f_list</strong> (<em>array</em>) – list of fractal dimensions analysed</p></li>
<li><p><strong>mieff_dir</strong> (<em>string</em>) – filepath to directory where .mieff files are stored</p></li>
<li><p><strong>colors</strong> (<em>array</em><em> (</em><em>optional</em><em>)</em>) – list of colors to use (in order: spheres, 1.2, 1.6, 2.0, 2.4, 2.8)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Wavelength-radius grid from .mieff files, overplotted with radii for each pressure layer for each fractal dimension.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justplotit.all_optics">
<span class="sig-prename descclassname"><span class="pre">virga.justplotit.</span></span><span class="sig-name descname"><span class="pre">all_optics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justplotit.all_optics" title="Link to this definition"></a></dt>
<dd><p>Maps of the wavelength dependent single scattering albedo
and cloud opacity and asymmetry parameter as a function of altitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>out</strong> (<em>dict</em>) – Dictionary output from pyeddy run</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Three bokeh plots with the single scattering, optical depth, and assymetry maps</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justplotit.all_optics_1d">
<span class="sig-prename descclassname"><span class="pre">virga.justplotit.</span></span><span class="sig-name descname"><span class="pre">all_optics_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('#0072B2',</span> <span class="pre">'#E69F00',</span> <span class="pre">'#F0E442',</span> <span class="pre">'#009E73',</span> <span class="pre">'#56B4E9',</span> <span class="pre">'#D55E00',</span> <span class="pre">'#CC79A7',</span> <span class="pre">'#000000')</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justplotit.all_optics_1d" title="Link to this definition"></a></dt>
<dd><p>Plots 1d profiles of optical depth per layer, single scattering, and
asymmetry averaged over the user input wave_range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out</strong> (<em>list</em><em> or </em><em>dict</em>) – Either a list of output dictionaries or a single dictionary output
from .compute(as_dict=True)</p></li>
<li><p><strong>wave_range</strong> (<em>list</em>) – min and max wavelength in microns</p></li>
<li><p><strong>return_output</strong> (<em>bool</em>) – Default is just to return a figure but you can also
return all the 1d profiles</p></li>
<li><p><strong>legend</strong> (<em>bool</em>) – Default is none. Legend for each component of out</p></li>
<li><p><strong>**kwargs</strong> (<em>keyword arguments</em>) – Key word arguments will be supplied to each bokeh figure function</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justplotit.condensate_mmr">
<span class="sig-prename descclassname"><span class="pre">virga.justplotit.</span></span><span class="sig-name descname"><span class="pre">condensate_mmr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compare</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justplotit.condensate_mmr" title="Link to this definition"></a></dt>
<dd><p>Condensate mean mass mixing ratio</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out</strong> (<em>dict</em>) – Dictionary output from pyeddy run</p></li>
<li><p><strong>color</strong> (<em>method</em>) – Method from bokeh.palletes. e.g. bokeh.palletes.virids, bokeh.palletes.magma</p></li>
<li><p><strong>**kwargs</strong> (<em>kwargs</em>) – Kwargs for bokeh.figure()</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justplotit.find_nearest_1d">
<span class="sig-prename descclassname"><span class="pre">virga.justplotit.</span></span><span class="sig-name descname"><span class="pre">find_nearest_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justplotit.find_nearest_1d" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justplotit.fsed_from_output">
<span class="sig-prename descclassname"><span class="pre">virga.justplotit.</span></span><span class="sig-name descname"><span class="pre">fsed_from_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pressure'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_indx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cld_bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_indx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justplotit.fsed_from_output" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justplotit.opd_by_gas">
<span class="sig-prename descclassname"><span class="pre">virga.justplotit.</span></span><span class="sig-name descname"><span class="pre">opd_by_gas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color=&lt;function</span> <span class="pre">magma&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compare=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justplotit.opd_by_gas" title="Link to this definition"></a></dt>
<dd><p>Optical depth for conservative geometric scatteres separated by gas.
E.g. [Fig 7 in Morley+2012](<a class="reference external" href="https://arxiv.org/pdf/1206.4313.pdf">https://arxiv.org/pdf/1206.4313.pdf</a>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out</strong> (<em>dict</em>) – Dictionary output from pyeddy run</p></li>
<li><p><strong>color</strong> (<em>method</em>) – Method from bokeh.palletes. e.g. bokeh.palletes.virids, bokeh.palletes.magma</p></li>
<li><p><strong>**kwargs</strong> (<em>kwargs</em>) – Kwargs for bokeh.figure()</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justplotit.plot_format">
<span class="sig-prename descclassname"><span class="pre">virga.justplotit.</span></span><span class="sig-name descname"><span class="pre">plot_format</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justplotit.plot_format" title="Link to this definition"></a></dt>
<dd><p>Function to reformat plots</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justplotit.plot_fsed">
<span class="sig-prename descclassname"><span class="pre">virga.justplotit.</span></span><span class="sig-name descname"><span class="pre">plot_fsed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pressure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pres_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justplotit.plot_fsed" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justplotit.pressure_fig">
<span class="sig-prename descclassname"><span class="pre">virga.justplotit.</span></span><span class="sig-name descname"><span class="pre">pressure_fig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justplotit.pressure_fig" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justplotit.pt">
<span class="sig-prename descclassname"><span class="pre">virga.justplotit.</span></span><span class="sig-name descname"><span class="pre">pt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_condensation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_condensation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justplotit.pt" title="Link to this definition"></a></dt>
<dd><p>Plot PT profiles with condensation curves.
Thick lines in this pt plot signify those gases that
were turned on in the run, NOT those that were recommended.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out</strong> (<em>dict</em>) – Dictionary output from pyeddy run</p></li>
<li><p><strong>with_condensation</strong> (<em>bool</em>) – Plots condensation curves of gases. Also plots those that were turned on in the
calculation with line_width=5. All others are set to 1.</p></li>
<li><p><strong>return_condensation</strong> (<em>bool</em>) – If true, it returns list of condenation temps for each gas, pressure grid,
and a list of the gas names</p></li>
<li><p><strong>**kwargs</strong> (<em>kwargs</em>) – Kwargs for bokeh.figure()</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>if return_condensation</strong> (<em>fig, cond temperature curves, ,cond pressure grid , name of all available gases</em>)</p></li>
<li><p><strong>else</strong> (<em>fig</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.justplotit.radii">
<span class="sig-prename descclassname"><span class="pre">virga.justplotit.</span></span><span class="sig-name descname"><span class="pre">radii</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">at_pressure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compare</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p1w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p1h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_indx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justplotit.radii" title="Link to this definition"></a></dt>
<dd><p>Plots the particle radii profile along with the distribution, at a certain pressure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out</strong> (<em>dict</em>) – Dictionary output from pyeddy run</p></li>
<li><p><strong>pressure</strong> (<em>float</em><em>,</em><em>optional</em>) – Pressure level to plot full distribution (bars)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-virga.optics">
<span id="virga-optics-module"></span><h2>virga.optics module<a class="headerlink" href="#module-virga.optics" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="virga.optics.get_refrind">
<span class="sig-prename descclassname"><span class="pre">virga.optics.</span></span><span class="sig-name descname"><span class="pre">get_refrind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">condensible</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'~/Documents/eddysed/input/optics'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.optics.get_refrind" title="Link to this definition"></a></dt>
<dd><p>Read old style refrind files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>condensible</strong> (<em>str</em>) – Condensible name (e.g. Al2O3)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>micron_wave, nn, kk as ndarrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.optics.init_optics">
<span class="sig-prename descclassname"><span class="pre">virga.optics.</span></span><span class="sig-name descname"><span class="pre">init_optics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">condensibles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_mie</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.optics.init_optics" title="Link to this definition"></a></dt>
<dd><p>Setup up a particle size grid and calculate single-particle scattering
and absorption efficiencies and other parameters to be used by
<cite>calc_optics()</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>do_optics</strong> (<em>bool</em>) – (True/False) Calculate optics (T) or use pre computed files (F)</p></li>
<li><p><strong>read_mie</strong> (<em>bool</em>) – (True/False) Read in Mie coefficients from pre compute files <cite>gas_name.mieff</cite></p></li>
<li><p><strong>condensibles</strong> (<em>list</em><em> of </em><em>str</em>) – Name in str of all condensible gases e.g. [‘H2O’,’CH4’]</p></li>
<li><p><strong>nrad</strong> (<em>int</em>) – Number of radius grid points</p></li>
<li><p><strong>rmin</strong> (<em>float</em>) – Minimum number of radius grid (cm)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>wave</strong> (<em>array</em>) – Wavelength bin centers (cm)</p></li>
<li><p><strong>radius</strong> (<em>array</em>) – Radius bin centers (cm)</p></li>
<li><p><strong>dr</strong> (<em>array</em>) – Widths of radius bins (cm)</p></li>
<li><p><strong>qscat</strong> (<em>array</em>) – Scattering efficiency</p></li>
<li><p><strong>qext</strong> (<em>array</em>) – Extinction efficiency</p></li>
<li><p><strong>cos_qscat</strong> (<em>array</em>) – qscat * acerage &lt;cos (scattering angle)&gt;</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-virga.pvaps">
<span id="virga-pvaps-module"></span><h2>virga.pvaps module<a class="headerlink" href="#module-virga.pvaps" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="virga.pvaps.Al2O3">
<span class="sig-prename descclassname"><span class="pre">virga.pvaps.</span></span><span class="sig-name descname"><span class="pre">Al2O3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.Al2O3" title="Link to this definition"></a></dt>
<dd><p>Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id12" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Wakeford, Hannah R., et al. “High temperature condensate clouds in super-hot Jupiter atmospheres.” Monthly Notices of the Royal Astronomical Society (2016): stw2639.</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.pvaps.CH4">
<span class="sig-prename descclassname"><span class="pre">virga.pvaps.</span></span><span class="sig-name descname"><span class="pre">CH4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.CH4" title="Link to this definition"></a></dt>
<dd><p>Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id13" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Lodders, K. &amp; Fegley, B. 1998, The planetary scientist’s companion / Katharina Lodders, Bruce Fegley.  New York : Oxford University Press, 1998. QB601 .L84 1998</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.pvaps.CaAl12O19">
<span class="sig-prename descclassname"><span class="pre">virga.pvaps.</span></span><span class="sig-name descname"><span class="pre">CaAl12O19</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.CaAl12O19" title="Link to this definition"></a></dt>
<dd><p>Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>p</strong> (<em>float</em>) – Pressure (dyne/cm^2)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id14" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Wakeford, Hannah R., et al. “High temperature condensate clouds in super-hot Jupiter atmospheres.” Monthly Notices of the Royal Astronomical Society (2016): stw2639.</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.pvaps.CaTiO3">
<span class="sig-prename descclassname"><span class="pre">virga.pvaps.</span></span><span class="sig-name descname"><span class="pre">CaTiO3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.CaTiO3" title="Link to this definition"></a></dt>
<dd><p>Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>p</strong> (<em>float</em>) – Pressure (dyne/cm^2)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id15" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Wakeford, Hannah R., et al. “High temperature condensate clouds in super-hot Jupiter atmospheres.” Monthly Notices of the Royal Astronomical Society (2016): stw2639.</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.pvaps.Cr">
<span class="sig-prename descclassname"><span class="pre">virga.pvaps.</span></span><span class="sig-name descname"><span class="pre">Cr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.Cr" title="Link to this definition"></a></dt>
<dd><p>Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id16" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Morley, Caroline V., et al. “Neglected clouds in T and Y dwarf atmospheres.” The Astrophysical Journal 756.2 (2012): 172.</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.pvaps.Fe">
<span class="sig-prename descclassname"><span class="pre">virga.pvaps.</span></span><span class="sig-name descname"><span class="pre">Fe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.Fe" title="Link to this definition"></a></dt>
<dd><p>Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id17" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Visscher, Channon, Katharina Lodders, and Bruce Fegley Jr. “Atmospheric chemistry in giant planets, brown dwarfs, and low-mass dwarf stars. III. Iron, magnesium, and silicon.” The Astrophysical Journal 716.2 (2010): 1060.</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.pvaps.H2O">
<span class="sig-prename descclassname"><span class="pre">virga.pvaps.</span></span><span class="sig-name descname"><span class="pre">H2O</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_buck</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.H2O" title="Link to this definition"></a></dt>
<dd><p>Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
<li><p><strong>do_buck</strong> (<em>bool</em>) – True means use Buck 1981 expresssion, False means use
Wexler’s</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id18" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Lodders, K. &amp; Fegley, B. 1998, The planetary scientist’s companion / Katharina Lodders, Bruce Fegley.  New York : Oxford University Press, 1998. QB601 .L84 1998</p>
</aside>
<aside class="footnote brackets" id="id19" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>Buck, Arden L. “New equations for computing vapor pressure and enhancement factor.” Journal of Applied Meteorology and Climatology 20.12 (1981): 1527-1532.</p>
</aside>
<aside class="footnote brackets" id="id20" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<p>Flatau, Piotr J., Robert L. Walko, and William R. Cotton. “Polynomial fits to saturation vapor pressure.” Journal of Applied Meteorology 31.12 (1992): 1507-1513.</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.pvaps.KCl">
<span class="sig-prename descclassname"><span class="pre">virga.pvaps.</span></span><span class="sig-name descname"><span class="pre">KCl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.KCl" title="Link to this definition"></a></dt>
<dd><p>Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id21" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Morley, C.~V., Fortney, J.~J., Marley, M.~S., Visscher, C., Saumon, D., Leggett, S.~K. 2012. Neglected Clouds in T and Y Dwarf Atmospheres. The Astrophysical Journal 756. doi:10.1088/0004-637X/756/2/172</p>
</aside>
<aside class="footnote brackets" id="id22" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>Lodders, K. 1999. Alkali Element Chemistry in Cool Dwarf Atmospheres. The Astrophysical Journal 519, 793–801. doi:10.1086/307387</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.pvaps.Mg2SiO4">
<span class="sig-prename descclassname"><span class="pre">virga.pvaps.</span></span><span class="sig-name descname"><span class="pre">Mg2SiO4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.Mg2SiO4" title="Link to this definition"></a></dt>
<dd><p>Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>p</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Pressure dyne/cm^2</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id23" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Visscher, Channon, Katharina Lodders, and Bruce Fegley Jr. “Atmospheric chemistry in giant planets, brown dwarfs, and low-mass dwarf stars. III. Iron, magnesium, and silicon.” The Astrophysical Journal 716.2 (2010): 1060.</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.pvaps.MgSiO3">
<span class="sig-prename descclassname"><span class="pre">virga.pvaps.</span></span><span class="sig-name descname"><span class="pre">MgSiO3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.MgSiO3" title="Link to this definition"></a></dt>
<dd><p>Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id24" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Visscher, Channon, Katharina Lodders, and Bruce Fegley Jr. “Atmospheric chemistry in giant planets, brown dwarfs, and low-mass dwarf stars. III. Iron, magnesium, and silicon.” The Astrophysical Journal 716.2 (2010): 1060.</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.pvaps.MnS">
<span class="sig-prename descclassname"><span class="pre">virga.pvaps.</span></span><span class="sig-name descname"><span class="pre">MnS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.MnS" title="Link to this definition"></a></dt>
<dd><p>Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id25" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Morley, Caroline V., et al. “Neglected clouds in T and Y dwarf atmospheres.” The Astrophysical Journal 756.2 (2012): 172.</p>
</aside>
<aside class="footnote brackets" id="id26" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>Visscher, Channon, Katharina Lodders, and Bruce Fegley Jr. “Atmospheric chemistry in giant planets, brown dwarfs, and low-mass dwarf stars. II. Sulfur and phosphorus.” The Astrophysical Journal 648.2 (2006): 1181.</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.pvaps.NH3">
<span class="sig-prename descclassname"><span class="pre">virga.pvaps.</span></span><span class="sig-name descname"><span class="pre">NH3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.NH3" title="Link to this definition"></a></dt>
<dd><p>Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id27" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Lodders, K. &amp; Fegley, B. 1998, The planetary scientist’s companion / Katharina Lodders, Bruce Fegley.  New York : Oxford University Press, 1998. QB601 .L84 1998</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.pvaps.Na2S">
<span class="sig-prename descclassname"><span class="pre">virga.pvaps.</span></span><span class="sig-name descname"><span class="pre">Na2S</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.Na2S" title="Link to this definition"></a></dt>
<dd><p>Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id28" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Morley, Caroline V., et al. “Neglected clouds in T and Y dwarf atmospheres.” The Astrophysical Journal 756.2 (2012): 172.</p>
</aside>
<aside class="footnote brackets" id="id29" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>Visscher, Channon, Katharina Lodders, and Bruce Fegley Jr. “Atmospheric chemistry in giant planets, brown dwarfs, and low-mass dwarf stars. II. Sulfur and phosphorus.” The Astrophysical Journal 648.2 (2006): 1181.</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.pvaps.SiO2">
<span class="sig-prename descclassname"><span class="pre">virga.pvaps.</span></span><span class="sig-name descname"><span class="pre">SiO2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.SiO2" title="Link to this definition"></a></dt>
<dd><p>PLACEHODER
Not suited yet for public use
Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id30" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>MADE UP</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.pvaps.TiO2">
<span class="sig-prename descclassname"><span class="pre">virga.pvaps.</span></span><span class="sig-name descname"><span class="pre">TiO2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.TiO2" title="Link to this definition"></a></dt>
<dd><p>Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id31" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Marley M.~S., Saumon D., Visscher C., Lupu R., Freedman R., Morley C., Fortney J.~J., et al., 2021, ApJ, 920, 85. doi:10.3847/1538-4357/ac141d</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.pvaps.ZnS">
<span class="sig-prename descclassname"><span class="pre">virga.pvaps.</span></span><span class="sig-name descname"><span class="pre">ZnS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.ZnS" title="Link to this definition"></a></dt>
<dd><p>Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id32" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Morley, Caroline V., et al. “Neglected clouds in T and Y dwarf atmospheres.” The Astrophysical Journal 756.2 (2012): 172.</p>
</aside>
<aside class="footnote brackets" id="id33" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>Visscher, Channon, Katharina Lodders, and Bruce Fegley Jr. “Atmospheric chemistry in giant planets, brown dwarfs, and low-mass dwarf stars. II. Sulfur and phosphorus.” The Astrophysical Journal 648.2 (2006): 1181.</p>
</aside>
</aside>
</dd></dl>

</section>
<section id="module-virga.root_functions">
<span id="virga-roo-functions-module"></span><h2>virga.roo_functions module<a class="headerlink" href="#module-virga.root_functions" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="virga.root_functions.advdiff">
<span class="sig-prename descclassname"><span class="pre">virga.root_functions.</span></span><span class="sig-name descname"><span class="pre">advdiff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ad_qbelow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ad_qvs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ad_mixl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ad_dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ad_rainf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'const'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.root_functions.advdiff" title="Link to this definition"></a></dt>
<dd><p>Calculate divergence from advective-diffusive balance for
condensate in a model layer</p>
<p>All units are cgs</p>
<ol class="upperalpha simple">
<li><p>Ackerman Feb-2000</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qt</strong> (<em>float</em>) – total mixing ratio of condensate + vapor (g/g)</p></li>
<li><p><strong>ad_qbelow</strong> (<em>float</em>) – total mixing ratio of vapor in underlying layer (g/g)</p></li>
<li><p><strong>ad_qvs</strong> (<em>float</em>) – saturation mixing ratio (g/g)</p></li>
<li><p><strong>ad_mixl</strong> (<em>float</em>) – convective mixing length (cm)</p></li>
<li><p><strong>ad_dz</strong> (<em>float</em>) – layer thickness (cm)</p></li>
<li><p><strong>ad_rainf</strong> (<em>float</em>) – rain efficiency factor</p></li>
<li><p><strong>zb</strong> (<em>float</em>) – altitude at bottom of layer</p></li>
<li><p><strong>b</strong> (<em>float</em>) – denominator of fsed exponential (if param is ‘exp’)</p></li>
<li><p><strong>param</strong> (<em>str</em>) – fsed parameterisation
‘const’ (constant), ‘exp’ (exponential density derivation)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ad_qc</strong> – mixing ratio of condensed condensate (g/g)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.root_functions.calculate_k0">
<span class="sig-prename descclassname"><span class="pre">virga.root_functions.</span></span><span class="sig-name descname"><span class="pre">calculate_k0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N_mon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Df</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.root_functions.calculate_k0" title="Link to this definition"></a></dt>
<dd><p>Find fractal prefactor k0 using Eq 15 of Moran &amp; Lodge (2025)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N_mon</strong> (<em>int</em>) – Number of monomers in aggregate</p></li>
<li><p><strong>Df</strong> (<em>float</em>) – Fractal dimension of aggregate</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>k0</strong> – Fractal prefactor k0</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.root_functions.find_N_mon_and_r_mon">
<span class="sig-prename descclassname"><span class="pre">virga.root_functions.</span></span><span class="sig-name descname"><span class="pre">find_N_mon_and_r_mon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N_mon_prescribed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original_N_mon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_mon</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.root_functions.find_N_mon_and_r_mon" title="Link to this definition"></a></dt>
<dd><p>Find the following variables for a given radius. One value should be prescribed by the user, but both
can change according to the growth model in Figure 2 of Moran &amp; Lodge (2025):</p>
<blockquote>
<div><ul class="simple">
<li><p>N_mon: Number of monomers</p></li>
<li><p>r_mon: monomer radius</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N_mon_prescribed</strong> (<em>int</em>) – Value of 1 if the user prescribed N_mon, 0 if they prescribed r_mon instead</p></li>
<li><p><strong>radius</strong> (<em>float</em>) – compact radius of aggregate (units:cm)</p></li>
<li><p><strong>original_N_mon</strong> (<em>int</em>) – original number of monomers prescribed by user</p></li>
<li><p><strong>r_mon</strong> (<em>float</em>) – monomer radius (units:cm)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>N_mon</strong> (<em>int</em>) – number of monomers</p></li>
<li><p><strong>r_mon</strong> (<em>float</em>) – monomer radius (units:cm)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.root_functions.find_cond_t">
<span class="sig-prename descclassname"><span class="pre">virga.root_functions.</span></span><span class="sig-name descname"><span class="pre">find_cond_t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_mmr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.root_functions.find_cond_t" title="Link to this definition"></a></dt>
<dd><p>Root function used used to find condensation temperature. E.g.
the temperature when</p>
<p>log p_vap = log partial pressure of gas</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t_test</strong> (<em>float</em>) – Temp (K)</p></li>
<li><p><strong>p_test</strong> (<em>float</em>) – Pressure bars</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log mh .. aka MH=1 for solar</p></li>
<li><p><strong>mmw</strong> (<em>float</em>) – mean molecular weight (2.2 for solar)</p></li>
<li><p><strong>gas_name</strong> (<em>str</em>) – gas name, case sensitive</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.root_functions.find_rg">
<span class="sig-prename descclassname"><span class="pre">virga.root_functions.</span></span><span class="sig-name descname"><span class="pre">find_rg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fsed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lognormal'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.root_functions.find_rg" title="Link to this definition"></a></dt>
<dd><p>Root function used used to find the geometric mean radius of
lognormal size distribution.</p>
<p>Useful if we consider more complicated size distributions for which
analytical expressions for moments are not easily obtained.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rg</strong> (<em>float</em>) – Geometric mean radius</p></li>
<li><p><strong>fsed</strong> (<em>float</em>) – Sedimentation efficiency</p></li>
<li><p><strong>rw</strong> (<em>float</em>) – Fall velocity particle radius</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – Exponent in power-law approximation for particle fall-speed</p></li>
<li><p><strong>s</strong> (<em>float</em>) – s = log(sigma) where sigma is the geometric std dev of lognormal distn</p></li>
<li><p><strong>loc</strong> (<em>float</em>) – Shift in lognormal distribution</p></li>
<li><p><strong>dist</strong> (<em>str</em>) – Continuous random variable for particle size distribution</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.root_functions.force_balance">
<span class="sig-prename descclassname"><span class="pre">virga.root_functions.</span></span><span class="sig-name descname"><span class="pre">force_balance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grav</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mw_atmos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mfp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">visc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_kinetics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.root_functions.force_balance" title="Link to this definition"></a></dt>
<dd><p>”
Define force balance for spherical particles falling in atmosphere, namely equate
gravitational and viscous drag forces.</p>
<p>Viscous drag assumed to be quadratic (Benchaita et al. 1983) and is a function of
the Reynolds number dependent drag coefficient.
Drag coefficient taken from Khan-Richardson model (Richardson et al. 2002) and
is valid for 1e-2 &lt; Re &lt; 1e5.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vf</strong> (<em>float</em>) – particle sedimentation velocity (cm/s)</p></li>
<li><p><strong>r</strong> (<em>float</em>) – particle radius (cm)</p></li>
<li><p><strong>grav</strong> (<em>float</em>) – acceleration of gravity (cm/s^2)</p></li>
<li><p><strong>mw_atmos</strong> (<em>float</em>) – atmospheric molecular weight (g/mol)</p></li>
<li><p><strong>mfp</strong> (<em>float</em>) – atmospheric molecular mean free path (cm)</p></li>
<li><p><strong>visc</strong> (<em>float</em>) – atmospheric dynamic viscosity (dyne s/cm^2) see Eqn. B2 in A&amp;M</p></li>
<li><p><strong>t</strong> (<em>float</em>) – atmospheric temperature (K)</p></li>
<li><p><strong>p</strong> (<em>float</em>) – atmospheric pressure (dyne/cm^2)</p></li>
<li><p><strong>rhop</strong> (<em>float</em>) – density of particle (g/cm^3)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.root_functions.moment">
<span class="sig-prename descclassname"><span class="pre">virga.root_functions.</span></span><span class="sig-name descname"><span class="pre">moment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lognormal'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.root_functions.moment" title="Link to this definition"></a></dt>
<dd><p>Calculate moment of size distribution.
Will be extended to include more than just lognormal</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>float</em>) – nth moment to be calculated</p></li>
<li><p><strong>s</strong> (<em>float</em>) – std dev</p></li>
<li><p><strong>loc</strong> (<em>float</em>) – Shift in distribution</p></li>
<li><p><strong>scale</strong> (<em>float</em>) – Scale distribution</p></li>
<li><p><strong>dist</strong> (<em>str</em>) – Continuous random variable for particle size distribution</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>moment_out</strong> – nth moment of distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.root_functions.qvs_below_model">
<span class="sig-prename descclassname"><span class="pre">virga.root_functions.</span></span><span class="sig-name descname"><span class="pre">qvs_below_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qv_dtdlnp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qv_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qv_t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qv_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qv_gas_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_below</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.root_functions.qvs_below_model" title="Link to this definition"></a></dt>
<dd><p>Calculates the pressure of saturation mixing ratio for a gas
that is extrapolated below the model domain.
This is specifically used if the gas has saturated
below the model grid</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.root_functions.solve_force_balance">
<span class="sig-prename descclassname"><span class="pre">virga.root_functions.</span></span><span class="sig-name descname"><span class="pre">solve_force_balance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solve_for</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grav</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mw_atmos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mfp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">visc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.root_functions.solve_force_balance" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>This can be used to equate gravitational and viscous drag forces to find either</dt><dd><ol class="loweralpha simple">
<li><p>fallspeed for a spherical particle of given radius, or</p></li>
<li><p>the radius of a particle falling with a particular speed</p></li>
</ol>
</dd>
</dl>
<p>at one layer in an atmosphere.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solve_for</strong> (<em>str</em>) – property we are solving force balance for
either “vfall” or “rw”</p></li>
<li><p><strong>temp</strong> (<em>float</em>) – <p>the other property needed to solve the force balance for solve_for
ie if solve_for=”vfall”, temp will be a radius (cm)</p>
<blockquote>
<div><p>if solve_for=”rw”, temp will be w_convect (cm/s)</p>
</div></blockquote>
</p></li>
<li><p><strong>grav</strong> (<em>float</em>) – acceleration of gravity (cm/s^2)</p></li>
<li><p><strong>mw_atmos</strong> (<em>float</em>) – atmospheric molecular weight (g/mol)</p></li>
<li><p><strong>mfp</strong> (<em>float</em>) – atmospheric molecular mean free path (cm)</p></li>
<li><p><strong>visc</strong> (<em>float</em>) – atmospheric dynamic viscosity (dyne s/cm^2) see Eqn. B2 in A&amp;M</p></li>
<li><p><strong>t</strong> (<em>float</em>) – atmospheric temperature (K)</p></li>
<li><p><strong>p</strong> (<em>float</em>) – atmospheric pressure (dyne/cm^2)</p></li>
<li><p><strong>rhop</strong> (<em>float</em>) – density of particle (g/cm^3)</p></li>
<li><p><strong>lo</strong> (<em>float</em>) – lower bound for root-finder</p></li>
<li><p><strong>hi</strong> (<em>float</em>) – upper bound for root-finder</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>soln.root</strong> – the value of the parameter solve_for</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.root_functions.vfall">
<span class="sig-prename descclassname"><span class="pre">virga.root_functions.</span></span><span class="sig-name descname"><span class="pre">vfall</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grav</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mw_atmos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mfp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">visc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_mon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_mon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.root_functions.vfall" title="Link to this definition"></a></dt>
<dd><p>New vfall function written by SEM and MGL, based on the methods of:</p>
<blockquote>
<div><ul class="simple">
<li><p>“Aggregate Cloud Particle Effects in Exoplanet Atmospheres”, Vahidinia et al. (2024)</p></li>
<li><p>“A Condensation–coalescence Cloud Model for Exoplanetary Atmospheres: Formulation and Test Applications to Terrestrial and Jovian Clouds”, Ohno and Okuzumi (2017)</p></li>
<li><p>“Theoretical modeling of mineral cloud formation on super-Earths”, K. Ohno (2024)</p></li>
</ul>
</div></blockquote>
<p>We adapt the above to include a broad range of aggregates and atmospheric conditions. The general outline of the code is:</p>
<blockquote>
<div><ul>
<li><p>Find the characteristic radius (R_c) of the particle:</p>
<blockquote>
<div><ul class="simple">
<li><p>SPHERES: R_c = radius of the sphere</p></li>
<li><p>AGGREGATES: R_c = radius of gyration</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Determine the Knudsen number:</p>
<blockquote>
<div><ul>
<li><p>If Kn &gt; 10 we are in the Free molecular regime (if the mean free path of the gas is large compared to the particle size).</p>
<blockquote>
<div><ul class="simple">
<li><p>Here, use equation 46 of Vahidinia et al. (2024) to adapt the fall velocity of spheres for aggregates of fractal dimension d_f</p></li>
</ul>
</div></blockquote>
</li>
<li><p>If Kn &lt; 10 we are in the Continuum regime (the gas can be treated a a continuous fluid)</p>
<blockquote>
<div><ul class="simple">
<li><p>Here, use equation 23 of Ohno and Okuzumi (2017) to calculate vfall for aggregates of any type, with the addition of the Beta slip correction
factor (Eq 3.11 of Ohno, 2024). This equation (Eq. 23) is valid for all three of the stokes, slip and turbulent regimes, so there is no need to calculate
Reynolds number. It is not strictly designed to work for really low fractal dimensions (e.g. DCLA aggregates with d_f = 1.2), so consider the effects
an upper bound for these if used (though aggregates in high atmospheres are not usually in the continuum regime anyway, they are in the Free molecular
regime. The use of mobility radius for linear DCLA aggregates was explored, but R_gyr was chosen to remain consistent and continuous as d_f changes.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>float</em>) – particle radius (cm)</p></li>
<li><p><strong>grav</strong> (<em>float</em>) – acceleration of gravity (cm/s^2)</p></li>
<li><p><strong>mw_atmos</strong> (<em>float</em>) – atmospheric molecular weight (g/mol)</p></li>
<li><p><strong>mfp</strong> (<em>float</em>) – atmospheric molecular mean free path (cm)</p></li>
<li><p><strong>visc</strong> (<em>float</em>) – atmospheric dynamic viscosity (dyne s/cm^2) see Eqn. B2 in A&amp;M</p></li>
<li><p><strong>t</strong> (<em>float</em>) – atmospheric temperature (K)</p></li>
<li><p><strong>p</strong> (<em>float</em>) – atmospheric pressure (dyne/cm^2)</p></li>
<li><p><strong>rhop</strong> (<em>float</em>) – density of particle (g/cm^3)</p></li>
<li><p><strong>aggregates</strong> (<em>bool</em><em>, </em><em>optional</em>) – Turns on aggregate functionality. set to False for default spheres.</p></li>
<li><p><strong>Df</strong> (<em>float</em><em>, </em><em>optional</em>) – fractal dimension of aggregate particle.</p></li>
<li><p><strong>N_mon</strong> (<em>float</em><em>, </em><em>optional</em>) – number of monomers in aggregate</p></li>
<li><p><strong>r_mon</strong> (<em>float</em><em>, </em><em>optional</em>) – the monomer radius (i.e., the smaller sub-particles) for aggregate particles (cm).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>v_fall</strong> – terminal velocity of particle (cm/s)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.root_functions.vfall_aggregates">
<span class="sig-prename descclassname"><span class="pre">virga.root_functions.</span></span><span class="sig-name descname"><span class="pre">vfall_aggregates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grav</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mw_atmos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ragg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.root_functions.vfall_aggregates" title="Link to this definition"></a></dt>
<dd><p>DEPRECATED, SEE CURRENT IMPLEMENTATION IN ‘VFALL’ FUNCTION
Calculate fallspeed for a particle at one layer in an
atmosphere, assuming low Reynolds number and in the molecular regime (Epstein drag),
i.e., where Knudsen number (mfp/r) is high (&gt;&gt;1).</p>
<p>User chooses whether particle is spherical or an aggregate.
If aggregrate, the monomer size is given by r and the outer effective radius of the aggregrate is Ragg.</p>
<p>all units are cgs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>float</em>) – monomer particle radius (cm)</p></li>
<li><p><strong>mw_atmos</strong> (<em>float</em>) – atmospheric molecular weight (g/mol)</p></li>
<li><p><strong>t</strong> (<em>float</em>) – atmospheric temperature (K)</p></li>
<li><p><strong>p</strong> (<em>float</em>) – atmospheric pressure (dyne/cm^2)</p></li>
<li><p><strong>rhop</strong> (<em>float</em>) – density of particle (g/cm^3)</p></li>
<li><p><strong>grav</strong> (<em>float</em>) – acceleration of gravity (cm/s^2)</p></li>
<li><p><strong>Ragg</strong> (<em>float</em>) – aggregate particle effective radius (cm). (Defaults to being spherical monomers).</p></li>
<li><p><strong>D</strong> (<em>float</em>) – fractal number (Default is 2 because function reduces to monomers at this value).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.root_functions.vfall_aggregrates_ohno">
<span class="sig-prename descclassname"><span class="pre">virga.root_functions.</span></span><span class="sig-name descname"><span class="pre">vfall_aggregrates_ohno</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grav</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mw_atmos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mfp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ad_qc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.root_functions.vfall_aggregrates_ohno" title="Link to this definition"></a></dt>
<dd><p>Calculates fallspeed for a fractal aggegrate particle as performed
by Ohno et al., 2020, with an outer
effective radius of R_agg made up of monomers of size r, at one layer in an
atmosphere. <a href="#id34"><span class="problematic" id="id35">**</span></a><a href="#id36"><span class="problematic" id="id37">*</span></a>Requires characteristic radius ragg to have D &gt; or equal 2, i.e., not very fluffy aggregrates.</p>
<p>Essentially a more explicit version of the regular “vfall_aggregates” function,
and is not dependent on being in free molecular (Esptein) regime</p>
<p>all units are cgs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>float</em>) – monomer particle radius (cm)</p></li>
<li><p><strong>grav</strong> (<em>float</em>) – acceleration of gravity (cm/s^2)</p></li>
<li><p><strong>rhop</strong> (<em>float</em>) – density of monomer particle (g/cm^3)</p></li>
<li><p><strong>t</strong> (<em>float</em>) – atmospheric temperature (K)</p></li>
<li><p><strong>p</strong> (<em>float</em>) – atmospheric pressure (dyne/cm^2)</p></li>
<li><p><strong>mw_atmos</strong> (<em>float</em>) – atmospheric molecular weight (g/mol)</p></li>
<li><p><strong>mfp</strong> (<em>float</em>) – atmospheric molecular mean free path (cm)</p></li>
<li><p><strong>ad_qc</strong> (<em>float</em>) – mixing ratio of condensed condensate (g/g)</p></li>
<li><p><strong>D</strong> (<em>float</em>) – fractal number (Default is 2).</p></li>
<li><p><strong>gas_mw</strong> (<em>float</em>) – condensate gas mean molecular weight (g/mol)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.root_functions.vfall_find_root">
<span class="sig-prename descclassname"><span class="pre">virga.root_functions.</span></span><span class="sig-name descname"><span class="pre">vfall_find_root</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grav</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mw_atmos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mfp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">visc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_convect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_mon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_mon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.root_functions.vfall_find_root" title="Link to this definition"></a></dt>
<dd><p>This is used to find F(X)-y=0 where F(X) is the fall speed for
a spherical particle and <cite>y</cite> is the convective velocity scale.
When the two are balanced we arrive at our correct particle radius.</p>
<p>Therefore, it is the same as the <cite>vfall</cite> function but with the
subtraction of the convective velocity scale (cm/s) w_convect.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="virga.root_functions.vfall_legacy">
<span class="sig-prename descclassname"><span class="pre">virga.root_functions.</span></span><span class="sig-name descname"><span class="pre">vfall_legacy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grav</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mw_atmos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mfp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">visc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhop</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virga.root_functions.vfall_legacy" title="Link to this definition"></a></dt>
<dd><p>Calculate fallspeed for a spherical particle at one layer in an
atmosphere, depending on Reynolds number for Stokes flow.</p>
<p>For Re_Stokes &lt; 1, use Stokes velocity with slip correction
For Re_Stokes &gt; 1, use fit to Re = exp( b1*x + b2*x^2 )</p>
<blockquote>
<div><p>where x = log( Cd Re^2 / 24 )
where b2 = -0.1 (curvature term) and
b1 from fit between Stokes at Re=1, Cd=24 and Re=1e3, Cd=0.45</p>
</div></blockquote>
<p>and Precipitation, Reidel, Holland, 1978) and Carlson, Rossow, and
Orton (J. Atmos. Sci. 45, p. 2066, 1988)</p>
<p>all units are cgs</p>
<ol class="upperalpha simple">
<li><p>Ackerman Feb-2000</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>float</em>) – particle radius (cm)</p></li>
<li><p><strong>grav</strong> (<em>float</em>) – acceleration of gravity (cm/s^2)</p></li>
<li><p><strong>mw_atmos</strong> (<em>float</em>) – atmospheric molecular weight (g/mol)</p></li>
<li><p><strong>mfp</strong> (<em>float</em>) – atmospheric molecular mean free path (cm)</p></li>
<li><p><strong>visc</strong> (<em>float</em>) – atmospheric dynamic viscosity (dyne s/cm^2) see Eqn. B2 in A&amp;M</p></li>
<li><p><strong>t</strong> (<em>float</em>) – atmospheric temperature (K)</p></li>
<li><p><strong>p</strong> (<em>float</em>) – atmospheric pressure (dyne/cm^2)</p></li>
<li><p><strong>rhop</strong> (<em>float</em>) – density of particle (g/cm^3)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-virga">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-virga" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="notebooks/12_Custom_Fractal_Aggregate_Aerosols.html" class="btn btn-neutral float-left" title="Custom Fractal Aggregate Aerosols" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>